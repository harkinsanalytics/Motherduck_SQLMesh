2025-09-13 14:32:38,304 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'md:champions_league_data'} (connection.py:489)
2025-09-13 14:32:38,662 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-09-13 14:32:38,662 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"champions_league_data"."sqlmesh_example"."full_model"' was not found at /Users/AaronHarkins/Python/SQLMesh_Motherduck/tests/test_full_model.yaml (console.py:2260)
2025-09-13 14:32:38,663 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: md:champions_league_data (connection.py:479)
2025-09-13 14:32:38,663 - MainThread - sqlmesh.core.console - WARNING - The motherduck engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-09-13 14:32:40,360 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0000_baseline' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0000_baseline.py'> (migrator.py:186)
2025-09-13 14:32:40,895 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0061_mysql_fix_blob_text_type' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0061_mysql_fix_blob_text_type.py'> (migrator.py:186)
2025-09-13 14:32:40,895 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0062_add_model_gateway' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0062_add_model_gateway.py'> (migrator.py:186)
2025-09-13 14:32:40,895 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0063_change_signals' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0063_change_signals.py'> (migrator.py:186)
2025-09-13 14:32:40,895 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0064_join_when_matched_strings' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0064_join_when_matched_strings.py'> (migrator.py:186)
2025-09-13 14:32:40,895 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0065_add_model_optimize' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0065_add_model_optimize.py'> (migrator.py:186)
2025-09-13 14:32:40,895 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0066_add_auto_restatements' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0066_add_auto_restatements.py'> (migrator.py:186)
2025-09-13 14:32:41,121 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0067_add_tsql_date_full_precision' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0067_add_tsql_date_full_precision.py'> (migrator.py:186)
2025-09-13 14:32:41,122 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0068_include_unrendered_query_in_metadata_hash' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0068_include_unrendered_query_in_metadata_hash.py'> (migrator.py:186)
2025-09-13 14:32:41,122 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0069_update_dev_table_suffix' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0069_update_dev_table_suffix.py'> (migrator.py:186)
2025-09-13 14:32:41,122 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0070_include_grains_in_metadata_hash' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0070_include_grains_in_metadata_hash.py'> (migrator.py:186)
2025-09-13 14:32:41,122 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0071_add_dev_version_to_intervals' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0071_add_dev_version_to_intervals.py'> (migrator.py:186)
2025-09-13 14:32:41,221 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0072_add_environment_statements' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0072_add_environment_statements.py'> (migrator.py:186)
2025-09-13 14:32:41,329 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0073_remove_symbolic_disable_restatement' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0073_remove_symbolic_disable_restatement.py'> (migrator.py:186)
2025-09-13 14:32:41,329 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0074_add_partition_by_time_column_property' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0074_add_partition_by_time_column_property.py'> (migrator.py:186)
2025-09-13 14:32:41,329 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0075_remove_validate_query' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0075_remove_validate_query.py'> (migrator.py:186)
2025-09-13 14:32:41,329 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0076_add_cron_tz' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0076_add_cron_tz.py'> (migrator.py:186)
2025-09-13 14:32:41,329 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0077_fix_column_type_hash_calculation' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0077_fix_column_type_hash_calculation.py'> (migrator.py:186)
2025-09-13 14:32:41,329 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0078_warn_if_non_migratable_python_env' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0078_warn_if_non_migratable_python_env.py'> (migrator.py:186)
2025-09-13 14:32:41,329 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0079_add_gateway_managed_property' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0079_add_gateway_managed_property.py'> (migrator.py:186)
2025-09-13 14:32:41,446 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0080_add_batch_size_to_scd_type_2_models' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0080_add_batch_size_to_scd_type_2_models.py'> (migrator.py:186)
2025-09-13 14:32:41,447 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0081_update_partitioned_by' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0081_update_partitioned_by.py'> (migrator.py:186)
2025-09-13 14:32:41,447 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0082_warn_if_incorrectly_duplicated_statements' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0082_warn_if_incorrectly_duplicated_statements.py'> (migrator.py:186)
2025-09-13 14:32:41,447 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0083_use_sql_for_scd_time_data_type_data_hash' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0083_use_sql_for_scd_time_data_type_data_hash.py'> (migrator.py:186)
2025-09-13 14:32:41,447 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0084_normalize_quote_when_matched_and_merge_filter' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0084_normalize_quote_when_matched_and_merge_filter.py'> (migrator.py:186)
2025-09-13 14:32:41,447 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0085_deterministic_repr' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0085_deterministic_repr.py'> (migrator.py:186)
2025-09-13 14:32:41,447 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0086_check_deterministic_bug' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0086_check_deterministic_bug.py'> (migrator.py:186)
2025-09-13 14:32:41,447 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0087_normalize_blueprint_variables' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0087_normalize_blueprint_variables.py'> (migrator.py:186)
2025-09-13 14:32:41,447 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0088_warn_about_variable_python_env_diffs' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0088_warn_about_variable_python_env_diffs.py'> (migrator.py:186)
2025-09-13 14:32:41,447 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0089_add_virtual_environment_mode' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0089_add_virtual_environment_mode.py'> (migrator.py:186)
2025-09-13 14:32:41,447 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0090_add_forward_only_column' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0090_add_forward_only_column.py'> (migrator.py:186)
2025-09-13 14:32:41,562 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0091_on_additive_change' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0091_on_additive_change.py'> (migrator.py:186)
2025-09-13 14:32:41,562 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0092_warn_about_dbt_data_type_diff' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0092_warn_about_dbt_data_type_diff.py'> (migrator.py:186)
2025-09-13 14:32:41,562 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0093_use_raw_sql_in_fingerprint' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0093_use_raw_sql_in_fingerprint.py'> (migrator.py:186)
2025-09-13 14:32:41,562 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0094_add_dev_version_and_fingerprint_columns' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0094_add_dev_version_and_fingerprint_columns.py'> (migrator.py:186)
2025-09-13 14:32:41,778 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0095_warn_about_dbt_raw_sql_diff' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0095_warn_about_dbt_raw_sql_diff.py'> (migrator.py:186)
2025-09-13 14:32:41,778 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0096_remove_plan_dags_table' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0096_remove_plan_dags_table.py'> (migrator.py:186)
2025-09-13 14:32:41,829 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0097_add_dbt_name_in_node' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0097_add_dbt_name_in_node.py'> (migrator.py:186)
2025-09-13 14:32:41,872 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Fetching environments (migrator.py:208)
2025-09-13 14:32:41,921 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Migrating snapshot rows... (migrator.py:225)
2025-09-13 14:32:41,924 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - No changes to snapshots detected (migrator.py:218)
2025-09-13 14:32:51,291 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-09-13 14:32:51,703 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-13 14:32:51,704 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__staging' (evaluator.py:1360)
2025-09-13 14:32:51,704 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__staging" (base.py:2466)
2025-09-13 14:32:51,803 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-13 14:32:51,806 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__staging (evaluator.py:1463)
2025-09-13 14:32:51,806 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:32:51,806 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:32:51,807 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_matches__3152486431', 'staging__stg_ucl_teams__1922017101') (base.py:2466)
2025-09-13 14:32:51,821 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_matches": 3506839202> (evaluator.py:701)
2025-09-13 14:32:51,821 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_matches": 3506839202> (evaluator.py:910)
2025-09-13 14:32:51,824 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-31 00:00:00, 2025-09-07 00:00:00) into champions_league_data.sqlmesh__staging.staging__stg_ucl_matches__3152486431' (evaluator.py:940)
2025-09-13 14:32:51,825 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__3152486431" (base.py:2466)
2025-09-13 14:32:51,921 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:32:51,922 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:32:51,922 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_matches__3152486431') (base.py:2466)
2025-09-13 14:32:51,925 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:32:51,926 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-13 14:32:51,928 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__3152486431" AS SELECT "competition_id" AS "competition_id", "competition_name" AS "competition_name", "competition_code" AS "competition_code", "season_id" AS "season_id", "season_startdate" AS "season_start_date", "season_enddate" AS "season_end_date", "season_currentmatchday" AS "season_current_matchday", "id" AS "match_id", CAST(CAST("utcdatem" AS TIMESTAMPTZ) AT TIME ZONE "america/new_york" AS TIMESTAMP) AS "match_datetime_est", "status" AS "match_status", "matchday" AS "matchday", "stage" AS "stage", "group" AS "group", "lastupdated" AS "lastupdated", "hometeam_id" AS "hometeam_id", "hometeam_name" AS "hometeam_name", "hometeam_shortname" AS "hometeam_shortname", "hometeam_tla" AS "hometeam_tla", "awayteam_id" AS "awayteam_id", "awayteam_name" AS "awayteam_name", "awayteam_shortname" AS "awayteam_shortname", "awayteam_tla" AS "awayteam_tla", "score_winner" AS "score_winner", "score_duration" AS "score_duration", "score_fulltime_home" AS "score_fulltime_home", "score_fulltime_away" AS "score_fulltime_away", "score_halftime_home" AS "score_halftime_home", "score_halftime_away" AS "score_halftime_away", "odds_msg" AS "odds_msg", "referees" AS "referees" FROM "champions_league_data"."main"."champions_league_matches" AS "champions_league_matches" (base.py:2466)
2025-09-13 14:32:52,021 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 4039740234> (evaluator.py:701)
2025-09-13 14:32:52,021 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 4039740234> (evaluator.py:910)
2025-09-13 14:32:52,025 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-31 00:00:00, 2025-09-07 00:00:00) into champions_league_data.sqlmesh__staging.staging__stg_ucl_teams__1922017101' (evaluator.py:940)
2025-09-13 14:32:52,031 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" (base.py:2466)
2025-09-13 14:32:52,128 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:32:52,130 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:32:52,132 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_teams__1922017101') (base.py:2466)
2025-09-13 14:32:52,140 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:32:52,142 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-13 14:32:52,144 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aee564ce4731449ea9d483a845c7f6df */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" AS SELECT "area_name" AS "area_name", "id" AS "team_id", "name" AS "team_name", "shortname" AS "team_short_name", "tla" AS "team_tla", "address" AS "team_address", "venue" AS "team_venue", "coach_id" AS "coach_id", "coach_firstname" AS "coach_first_name", "coach_lastname" AS "coach_last_name", "coach_name" AS "coach_name", "coach_nationality" AS "coach_nationality", "coach_contract_start" AS "coach_contract_start", "coach_contract_until" AS "coach_contract_until", "lastupdated" AS "lastupdated", "latitude" AS "latitude", "longitude" AS "longitude" FROM "champions_league_data"."main"."champions_league_teams" AS "champions_league_teams" (base.py:2466)
2025-09-13 14:32:52,250 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-31 00:00:00, 2025-09-07 00:00:00) for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 4039740234> (facade.py:622)
2025-09-13 14:32:52,250 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 4039740234> (interval.py:214)
2025-09-13 14:32:52,543 - MainThread - sqlmesh.core.scheduler - INFO - Execution failed for node EvaluateNode(snapshot_name='"champions_league_data"."staging"."stg_ucl_matches"', interval=(1756598400000, 1757203200000), batch_index=0) (scheduler.py:597)
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/utils/concurrency.py", line 234, in sequential_apply_to_dag
    fn(node)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/scheduler.py", line 533, in run_node
    audit_results = self.evaluate(
                    ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/scheduler.py", line 229, in evaluate
    wap_id = self.snapshot_evaluator.evaluate(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/snapshot/evaluator.py", line 182, in evaluate
    result = self._evaluate_snapshot(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/snapshot/evaluator.py", line 797, in _evaluate_snapshot
    self._render_and_insert_snapshot(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/snapshot/evaluator.py", line 990, in _render_and_insert_snapshot
    apply(query_or_df, index)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/snapshot/evaluator.py", line 946, in apply
    evaluation_strategy.insert(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/snapshot/evaluator.py", line 2116, in insert
    self._replace_query_for_model(model, table_name, query_or_df, render_kwargs, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/snapshot/evaluator.py", line 1864, in _replace_query_for_model
    self.adapter.replace_query(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/shared.py", line 312, in internal_wrapper
    return func(*list_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/base.py", line 512, in replace_query
    return self._create_table_from_source_queries(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/base.py", line 917, in _create_table_from_source_queries
    self._create_table(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/duckdb.py", line 188, in _create_table
    super()._create_table(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/base.py", line 960, in _create_table
    self.execute(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/base.py", line 2443, in execute
    self._execute(sql, track_rows_processed, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/base.py", line 2475, in _execute
    self.cursor.execute(sql, **kwargs)
duckdb.duckdb.BinderException: Binder Error: Referenced column "america/new_york" not found in FROM clause!
Candidate bindings: "area_name", "area_code", "score_winner", "area_id", "score_duration"

LINE 1: ... "match_id", CAST(CAST("utcdatem" AS TIMESTAMPTZ) AT TIME ZONE "america/new_york" AS TIMESTAMP) AS "match_datetime_est...
                                                                          ^

The above exception was the direct cause of the following exception:

sqlmesh.utils.concurrency.NodeExecutionFailedError: Execution failed for node EvaluateNode(snapshot_name='"champions_league_data"."staging"."stg_ucl_matches"', interval=(1756598400000, 1757203200000), batch_index=0)
2025-09-13 14:32:52,551 - MainThread - sqlmesh.core.context - INFO - Plan application failed. (context.py:1735)
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/context.py", line 1727, in apply
    self._apply(plan, circuit_breaker)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/context.py", line 2519, in _apply
    self._scheduler.create_plan_evaluator(self).evaluate(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/plan/evaluator.py", line 107, in evaluate
    self._evaluate_stages(plan_stages, plan)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/plan/evaluator.py", line 127, in _evaluate_stages
    handler(stage, plan)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/plan/evaluator.py", line 265, in visit_backfill_stage
    raise PlanError("Plan application failed.")
sqlmesh.utils.errors.PlanError: Plan application failed.
2025-09-13 14:32:52,552 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
