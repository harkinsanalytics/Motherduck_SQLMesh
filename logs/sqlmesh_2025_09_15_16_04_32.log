2025-09-15 16:04:32,719 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'md:champions_league_data'} (connection.py:489)
2025-09-15 16:04:33,094 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-09-15 16:04:33,094 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"champions_league_data"."sqlmesh_example"."full_model"' was not found at /Users/AaronHarkins/Python/SQLMesh_Motherduck/tests/test_full_model.yaml (console.py:2260)
2025-09-15 16:04:33,096 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: md:champions_league_data (connection.py:479)
2025-09-15 16:04:33,096 - MainThread - sqlmesh.core.console - WARNING - The motherduck engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-09-15 16:04:36,832 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-09-15 16:04:37,227 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-15 16:04:37,228 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__staging' (evaluator.py:1360)
2025-09-15 16:04:37,229 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__staging" (base.py:2466)
2025-09-15 16:04:37,269 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__intermediate' (evaluator.py:1360)
2025-09-15 16:04:37,269 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__intermediate" (base.py:2466)
2025-09-15 16:04:37,312 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-15 16:04:37,314 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__intermediate (evaluator.py:1463)
2025-09-15 16:04:37,315 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:37,316 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:37,317 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__intermediate') AND table_name IN ('intermediate__int_ucl_teams__4282581205') (base.py:2466)
2025-09-15 16:04:37,330 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_teams": 3589112407> (evaluator.py:701)
2025-09-15 16:04:37,331 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_teams": 3589112407> (evaluator.py:910)
2025-09-15 16:04:37,335 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-31 00:00:00, 2025-09-07 00:00:00) into champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_teams__4282581205' (evaluator.py:940)
2025-09-15 16:04:37,335 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ DESCRIBE "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__4282581205" (base.py:2466)
2025-09-15 16:04:37,418 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:37,419 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:37,420 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__intermediate') AND table_name IN ('intermediate__int_ucl_teams__4282581205') (base.py:2466)
2025-09-15 16:04:37,429 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:37,430 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 16:04:37,434 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__4282581205" AS SELECT "t"."area_name" AS "area_name", "t"."team_id" AS "team_id", "t"."team_name" AS "team_name", "t"."team_short_name" AS "team_short_name", "t"."team_tla" AS "team_tla", "t"."team_address" AS "team_address", "t"."team_venue" AS "team_venue", "t"."coach_id" AS "coach_id", "t"."coach_first_name" AS "coach_first_name", "t"."coach_last_name" AS "coach_last_name", "t"."coach_name" AS "coach_name", "t"."coach_nationality" AS "coach_nationality", "t"."coach_contract_start" AS "coach_contract_start", "t"."coach_contract_until" AS "coach_contract_until", "t"."lastupdated" AS "lastupdated", COALESCE("t"."latitude", "l"."latitude") AS "latitude", COALESCE("t"."longitude", "l"."longitude") AS "longitude", "r"."rank" AS "rank" FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" AS "t" JOIN "champions_league_data"."main"."ucl_teams_city_latlong" AS "l" ON "t"."team_id" = "l"."team_id" JOIN "champions_league_data"."main"."ucl_european_rankings" AS "r" ON "t"."team_id" = "r"."team_id" (base.py:2466)
2025-09-15 16:04:37,578 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-31 00:00:00, 2025-09-07 00:00:00) for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_teams": 3589112407> (facade.py:622)
2025-09-15 16:04:37,578 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_teams": 3589112407> (interval.py:214)
2025-09-15 16:04:37,868 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-09-15 16:04:37,868 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-15 16:04:38,409 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage MigrateSchemasStage (evaluator.py:125)
2025-09-15 16:04:38,410 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__staging (evaluator.py:1463)
2025-09-15 16:04:38,410 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:38,410 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:38,412 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_matches__2354879629', 'staging__stg_ucl_teams__1922017101') (base.py:2466)
2025-09-15 16:04:38,422 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_matches__2354879629_schema_tmp' (evaluator.py:1768)
2025-09-15 16:04:38,423 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:38,423 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 16:04:38,425 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ CREATE TABLE IF NOT EXISTS "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__2354879629_schema_tmp" AS SELECT "competition_id" AS "competition_id", "competition_name" AS "competition_name", "competition_code" AS "competition_code", "season_id" AS "season_id", "season_startdate" AS "season_start_date", "season_enddate" AS "season_end_date", "season_currentmatchday" AS "season_current_matchday", "id" AS "match_id", CAST(CAST("utcdate" AS TIMESTAMPTZ) AT TIME ZONE 'America/New_York' AS TIMESTAMP) AS "match_datetime_est", "status" AS "match_status", "matchday" AS "matchday", "stage" AS "stage", "group" AS "group", "lastupdated" AS "lastupdated", "hometeam_id" AS "hometeam_id", "hometeam_name" AS "hometeam_name", "hometeam_shortname" AS "hometeam_shortname", "hometeam_tla" AS "hometeam_tla", "awayteam_id" AS "awayteam_id", "awayteam_name" AS "awayteam_name", "awayteam_shortname" AS "awayteam_shortname", "awayteam_tla" AS "awayteam_tla", "score_winner" AS "score_winner", "score_duration" AS "score_duration", "score_fulltime_home" AS "score_fulltime_home", "score_fulltime_away" AS "score_fulltime_away", "score_halftime_home" AS "score_halftime_home", "score_halftime_away" AS "score_halftime_away", "odds_msg" AS "odds_msg", "referees" AS "referees" FROM "champions_league_data"."main"."champions_league_matches" AS "champions_league_matches" WHERE FALSE LIMIT 0 (base.py:2466)
2025-09-15 16:04:38,523 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Migrating table schema from 'champions_league_data.sqlmesh__staging.staging__stg_ucl_matches__2354879629_schema_tmp' to 'champions_league_data.sqlmesh__staging.staging__stg_ucl_matches__2354879629' (evaluator.py:1127)
2025-09-15 16:04:38,523 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Altering table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_matches__2354879629' (evaluator.py:1817)
2025-09-15 16:04:38,524 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__2354879629" (base.py:2466)
2025-09-15 16:04:38,526 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__2354879629_schema_tmp" (base.py:2466)
2025-09-15 16:04:38,528 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ DROP TABLE IF EXISTS "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__2354879629_schema_tmp" (base.py:2466)
2025-09-15 16:04:38,649 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_teams__1922017101_schema_tmp' (evaluator.py:1768)
2025-09-15 16:04:38,649 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:38,656 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 16:04:38,661 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ CREATE TABLE IF NOT EXISTS "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101_schema_tmp" AS SELECT "area_name" AS "area_name", "id" AS "team_id", "name" AS "team_name", "shortname" AS "team_short_name", "tla" AS "team_tla", "address" AS "team_address", "venue" AS "team_venue", "coach_id" AS "coach_id", "coach_firstname" AS "coach_first_name", "coach_lastname" AS "coach_last_name", "coach_name" AS "coach_name", "coach_nationality" AS "coach_nationality", "coach_contract_start" AS "coach_contract_start", "coach_contract_until" AS "coach_contract_until", "lastupdated" AS "lastupdated", "latitude" AS "latitude", "longitude" AS "longitude" FROM "champions_league_data"."main"."champions_league_teams" AS "champions_league_teams" WHERE FALSE LIMIT 0 (base.py:2466)
2025-09-15 16:04:38,764 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Migrating table schema from 'champions_league_data.sqlmesh__staging.staging__stg_ucl_teams__1922017101_schema_tmp' to 'champions_league_data.sqlmesh__staging.staging__stg_ucl_teams__1922017101' (evaluator.py:1127)
2025-09-15 16:04:38,764 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Altering table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_teams__1922017101' (evaluator.py:1817)
2025-09-15 16:04:38,764 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" (base.py:2466)
2025-09-15 16:04:38,767 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101_schema_tmp" (base.py:2466)
2025-09-15 16:04:38,769 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ DROP TABLE IF EXISTS "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101_schema_tmp" (base.py:2466)
2025-09-15 16:04:38,869 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-09-15 16:04:39,026 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-09-15 16:04:39,031 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.intermediate' (evaluator.py:1360)
2025-09-15 16:04:39,031 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."intermediate" (base.py:2466)
2025-09-15 16:04:39,071 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.staging' (evaluator.py:1360)
2025-09-15 16:04:39,071 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."staging" (base.py:2466)
2025-09-15 16:04:39,111 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_matches' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_matches__2354879629' (evaluator.py:1732)
2025-09-15 16:04:39,112 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:39,113 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:39,114 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_matches') (base.py:2466)
2025-09-15 16:04:39,117 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_matches" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__2354879629" (base.py:2466)
2025-09-15 16:04:39,213 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_squads' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_squads__1660759538' (evaluator.py:1732)
2025-09-15 16:04:39,213 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:39,214 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:39,215 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_squads') (base.py:2466)
2025-09-15 16:04:39,217 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_squads" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_squads__1660759538" (base.py:2466)
2025-09-15 16:04:39,329 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_teams' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_teams__1922017101' (evaluator.py:1732)
2025-09-15 16:04:39,330 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:39,330 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:39,331 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_teams') (base.py:2466)
2025-09-15 16:04:39,336 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_teams" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" (base.py:2466)
2025-09-15 16:04:39,428 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.intermediate.int_ucl_teams' to point at table 'champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_teams__4282581205' (evaluator.py:1732)
2025-09-15 16:04:39,430 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:39,431 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:04:39,433 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'intermediate') AND table_name IN ('int_ucl_teams') (base.py:2466)
2025-09-15 16:04:39,438 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f5271a306486485ab33b94a9b2b26f99 */ CREATE OR REPLACE VIEW "champions_league_data"."intermediate"."int_ucl_teams" AS SELECT * FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__4282581205" (base.py:2466)
2025-09-15 16:04:39,571 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-09-15 16:04:39,571 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-09-15 16:04:39,672 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
