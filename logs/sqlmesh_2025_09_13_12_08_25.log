2025-09-13 12:08:25,658 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'md:champions_league_data'} (connection.py:489)
2025-09-13 12:08:25,900 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-09-13 12:08:25,926 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: md:champions_league_data (connection.py:479)
2025-09-13 12:08:25,926 - MainThread - sqlmesh.core.console - WARNING - The motherduck engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-09-13 12:08:28,237 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-09-13 12:08:28,608 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-13 12:08:28,609 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__staging' (evaluator.py:1360)
2025-09-13 12:08:28,609 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__staging" (base.py:2466)
2025-09-13 12:08:28,700 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__sqlmesh_example' (evaluator.py:1360)
2025-09-13 12:08:28,700 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__sqlmesh_example" (base.py:2466)
2025-09-13 12:08:28,837 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-13 12:08:28,840 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__staging (evaluator.py:1463)
2025-09-13 12:08:28,840 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 12:08:28,841 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 12:08:28,842 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_teams__1922017101') (base.py:2466)
2025-09-13 12:08:28,851 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__sqlmesh_example (evaluator.py:1463)
2025-09-13 12:08:28,851 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 12:08:28,851 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 12:08:28,852 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__full_model__4198045951', 'sqlmesh_example__incremental_model__202281659') (base.py:2466)
2025-09-13 12:08:28,854 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating a physical table for snapshot SnapshotId<"champions_league_data"."sqlmesh_example"."incremental_model": 218577868> (evaluator.py:838)
2025-09-13 12:08:28,857 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'champions_league_data.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__202281659' (evaluator.py:1768)
2025-09-13 12:08:28,857 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 12:08:28,858 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-13 12:08:28,858 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ CREATE TABLE IF NOT EXISTS "champions_league_data"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__202281659" AS SELECT "id" AS "id", "item_id" AS "item_id", "event_date" AS "event_date" FROM "champions_league_data"."sqlmesh_example"."seed_model" AS "seed_model" WHERE "event_date" BETWEEN CAST('1970-01-01' AS DATE) AND CAST('1970-01-01' AS DATE) AND FALSE LIMIT 0 (base.py:2466)
2025-09-13 12:08:28,939 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 4039740234> (evaluator.py:701)
2025-09-13 12:08:28,942 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 4039740234> (evaluator.py:910)
2025-09-13 12:08:28,945 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-31 00:00:00, 2025-09-07 00:00:00) into champions_league_data.sqlmesh__staging.staging__stg_ucl_teams__1922017101' (evaluator.py:940)
2025-09-13 12:08:28,945 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" (base.py:2466)
2025-09-13 12:08:29,027 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 12:08:29,028 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 12:08:29,030 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_teams__1922017101') (base.py:2466)
2025-09-13 12:08:29,034 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 12:08:29,035 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-13 12:08:29,037 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 8aa0339ab983466da1c8ee15ccb95190 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" AS SELECT "area_name" AS "area_name", "id" AS "team_id", "name" AS "team_name", "shortname" AS "team_short_name", "tla" AS "team_tla", "address" AS "team_address", "venue" AS "team_venue", "coach_id" AS "coach_id", "coach_firstname" AS "coach_first_name", "coach_lastname" AS "coach_last_name", "coach_name" AS "coach_name", "coach_nationality" AS "coach_nationality", "coach_contract_start" AS "coach_contract_start", "coach_contract_until" AS "coach_contract_until", "lastupdated" AS "lastupdated", "latitude" AS "latitude", "longitude" AS "longitude" FROM "champions_league_data"."main"."champions_league_teams" AS "champions_league_teams" (base.py:2466)
2025-09-13 12:08:29,155 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-31 00:00:00, 2025-09-07 00:00:00) for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 4039740234> (facade.py:622)
2025-09-13 12:08:29,155 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 4039740234> (interval.py:214)
2025-09-13 12:08:29,442 - MainThread - sqlmesh.core.scheduler - INFO - SKIPPED snapshot "champions_league_data"."sqlmesh_example"."incremental_model"
 (scheduler.py:592)
2025-09-13 12:08:29,442 - MainThread - sqlmesh.core.scheduler - INFO - SKIPPED snapshot "champions_league_data"."sqlmesh_example"."full_model"
 (scheduler.py:592)
2025-09-13 12:08:29,442 - MainThread - sqlmesh.core.scheduler - INFO - Execution failed for node CreateNode(snapshot_name='"champions_league_data"."sqlmesh_example"."incremental_model"') (scheduler.py:597)
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/utils/concurrency.py", line 234, in sequential_apply_to_dag
    fn(node)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/scheduler.py", line 569, in run_node
    self.snapshot_evaluator.create_snapshot(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/snapshot/evaluator.py", line 868, in create_snapshot
    self._execute_create(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/snapshot/evaluator.py", line 1403, in _execute_create
    evaluation_strategy.create(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/snapshot/evaluator.py", line 1793, in create
    self.adapter.ctas(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/shared.py", line 312, in internal_wrapper
    return func(*list_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/base.py", line 694, in ctas
    return self._create_table_from_source_queries(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/base.py", line 917, in _create_table_from_source_queries
    self._create_table(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/duckdb.py", line 188, in _create_table
    super()._create_table(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/base.py", line 960, in _create_table
    self.execute(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/base.py", line 2443, in execute
    self._execute(sql, track_rows_processed, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/engine_adapter/base.py", line 2475, in _execute
    self.cursor.execute(sql, **kwargs)
duckdb.duckdb.CatalogException: Catalog Error: Table with name seed_model does not exist!
Did you mean "main.sqlite_master"?

LINE 1: ...", "item_id" AS "item_id", "event_date" AS "event_date" FROM "champions_league_data"."sqlmesh_example"."seed_model" AS...
                                                                        ^

The above exception was the direct cause of the following exception:

sqlmesh.utils.concurrency.NodeExecutionFailedError: Execution failed for node CreateNode(snapshot_name='"champions_league_data"."sqlmesh_example"."incremental_model"')
2025-09-13 12:08:29,448 - MainThread - sqlmesh.core.context - INFO - Plan application failed. (context.py:1735)
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/context.py", line 1727, in apply
    self._apply(plan, circuit_breaker)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/context.py", line 2519, in _apply
    self._scheduler.create_plan_evaluator(self).evaluate(
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/plan/evaluator.py", line 107, in evaluate
    self._evaluate_stages(plan_stages, plan)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/plan/evaluator.py", line 127, in _evaluate_stages
    handler(stage, plan)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/core/plan/evaluator.py", line 265, in visit_backfill_stage
    raise PlanError("Plan application failed.")
sqlmesh.utils.errors.PlanError: Plan application failed.
2025-09-13 12:08:29,448 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
