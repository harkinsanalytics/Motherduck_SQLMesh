2025-09-15 20:01:08,697 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'md:champions_league_data'} (connection.py:489)
2025-09-15 20:01:09,102 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-09-15 20:01:09,103 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"champions_league_data"."sqlmesh_example"."full_model"' was not found at /Users/AaronHarkins/Python/SQLMesh_Motherduck/tests/test_full_model.yaml (console.py:2260)
2025-09-15 20:01:09,104 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: md:champions_league_data (connection.py:479)
2025-09-15 20:01:09,104 - MainThread - sqlmesh.core.console - WARNING - The motherduck engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-09-15 20:01:12,824 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-09-15 20:01:13,314 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-15 20:01:13,315 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__intermediate' (evaluator.py:1360)
2025-09-15 20:01:13,316 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__intermediate" (base.py:2466)
2025-09-15 20:01:13,362 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__staging' (evaluator.py:1360)
2025-09-15 20:01:13,363 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__staging" (base.py:2466)
2025-09-15 20:01:13,407 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__facts' (evaluator.py:1360)
2025-09-15 20:01:13,408 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__facts" (base.py:2466)
2025-09-15 20:01:13,462 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-15 20:01:13,467 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__staging (evaluator.py:1463)
2025-09-15 20:01:13,468 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:01:13,470 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:01:13,472 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_latlong__287275338') (base.py:2466)
2025-09-15 20:01:13,493 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_latlong": 1268373028> (evaluator.py:701)
2025-09-15 20:01:13,494 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_latlong": 1268373028> (evaluator.py:910)
2025-09-15 20:01:13,499 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-31 00:00:00, 2025-09-07 00:00:00) into champions_league_data.sqlmesh__staging.staging__stg_ucl_latlong__287275338' (evaluator.py:940)
2025-09-15 20:01:13,500 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__287275338" (base.py:2466)
2025-09-15 20:01:13,580 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:01:13,581 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:01:13,582 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_latlong__287275338') (base.py:2466)
2025-09-15 20:01:13,585 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:01:13,585 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 20:01:13,586 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__287275338" AS SELECT "team_id" AS "team_id", (CASE WHEN LOWER(TRIM("latitude")) LIKE '%s%' THEN -1 ELSE 1 END) * CAST(REGEXP_REPLACE(TRIM("latitude"), '[^0-9.+-]', '', 'g') AS DOUBLE) AS "latitude", (CASE WHEN LOWER(TRIM("longitude")) LIKE '%w%' THEN -1 ELSE 1 END) * CAST(REGEXP_REPLACE(TRIM("longitude"), '[^0-9.+-]', '', 'g') AS DOUBLE) AS "longitude" FROM "ucl_teams_city_latlong" AS "ucl_teams_city_latlong" (base.py:2466)
2025-09-15 20:01:13,728 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ COMMENT ON COLUMN "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__287275338"."team_id" IS 'Latitude: negative if ''S''' (base.py:2466)
2025-09-15 20:01:13,874 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-31 00:00:00, 2025-09-07 00:00:00) for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_latlong": 1268373028> (facade.py:622)
2025-09-15 20:01:13,874 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_latlong": 1268373028> (interval.py:214)
2025-09-15 20:01:14,179 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-09-15 20:01:14,180 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-15 20:01:14,864 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-09-15 20:01:15,026 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-09-15 20:01:15,028 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.staging' (evaluator.py:1360)
2025-09-15 20:01:15,028 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."staging" (base.py:2466)
2025-09-15 20:01:15,069 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_latlong' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_latlong__287275338' (evaluator.py:1732)
2025-09-15 20:01:15,070 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:01:15,070 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:01:15,071 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_latlong') (base.py:2466)
2025-09-15 20:01:15,074 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_latlong" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__287275338" (base.py:2466)
2025-09-15 20:01:15,180 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0dbed4dca7f247029dce0de8bfd3c3db */ COMMENT ON COLUMN "champions_league_data"."staging"."stg_ucl_latlong"."team_id" IS 'Latitude: negative if ''S''' (base.py:2466)
2025-09-15 20:01:15,291 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-09-15 20:01:15,291 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-09-15 20:01:15,422 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
