2025-09-16 17:01:05,831 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'md:champions_league_data'} (connection.py:489)
2025-09-16 17:01:06,221 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-09-16 17:01:06,221 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"champions_league_data"."sqlmesh_example"."full_model"' was not found at /Users/AaronHarkins/Python/SQLMesh_Motherduck/tests/test_full_model.yaml (console.py:2260)
2025-09-16 17:01:06,223 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: md:champions_league_data (connection.py:479)
2025-09-16 17:01:06,223 - MainThread - sqlmesh.core.console - WARNING - The motherduck engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-09-16 17:01:09,203 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-09-16 17:01:09,676 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-16 17:01:09,678 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__intermediate' (evaluator.py:1360)
2025-09-16 17:01:09,678 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__intermediate" (base.py:2466)
2025-09-16 17:01:09,719 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__facts' (evaluator.py:1360)
2025-09-16 17:01:09,719 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__facts" (base.py:2466)
2025-09-16 17:01:09,759 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__snapshots' (evaluator.py:1360)
2025-09-16 17:01:09,759 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__snapshots" (base.py:2466)
2025-09-16 17:01:09,800 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__staging' (evaluator.py:1360)
2025-09-16 17:01:09,800 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__staging" (base.py:2466)
2025-09-16 17:01:09,844 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-16 17:01:09,849 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__snapshots (evaluator.py:1463)
2025-09-16 17:01:09,850 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:01:09,851 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:01:09,856 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__snapshots') AND table_name IN ('snapshots__ucl_team_snapshot__1765145592') (base.py:2466)
2025-09-16 17:01:09,877 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_team_snapshot": 401451744> (evaluator.py:701)
2025-09-16 17:01:09,878 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_team_snapshot": 401451744> (evaluator.py:910)
2025-09-16 17:01:09,886 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-01 00:00:00, 2025-09-01 00:00:00) into champions_league_data.sqlmesh__snapshots.snapshots__ucl_team_snapshot__1765145592' (evaluator.py:940)
2025-09-16 17:01:09,886 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ DESCRIBE "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_team_snapshot__1765145592" (base.py:2466)
2025-09-16 17:01:09,961 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:01:09,962 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:01:09,964 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__snapshots') AND table_name IN ('snapshots__ucl_team_snapshot__1765145592') (base.py:2466)
2025-09-16 17:01:09,969 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:01:09,970 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-16 17:01:09,974 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_team_snapshot__1765145592" AS SELECT "int_ucl_teams"."area_name" AS "area_name", "int_ucl_teams"."team_id" AS "team_id", "int_ucl_teams"."team_name" AS "team_name", "int_ucl_teams"."team_short_name" AS "team_short_name", "int_ucl_teams"."team_tla" AS "team_tla", "int_ucl_teams"."team_address" AS "team_address", "int_ucl_teams"."team_venue" AS "team_venue", "int_ucl_teams"."coach_id" AS "coach_id", "int_ucl_teams"."coach_first_name" AS "coach_first_name", "int_ucl_teams"."coach_last_name" AS "coach_last_name", "int_ucl_teams"."coach_name" AS "coach_name", "int_ucl_teams"."coach_nationality" AS "coach_nationality", "int_ucl_teams"."coach_contract_start" AS "coach_contract_start", "int_ucl_teams"."coach_contract_until" AS "coach_contract_until", "int_ucl_teams"."lastupdated" AS "lastupdated", "int_ucl_teams"."latitude" AS "latitude", "int_ucl_teams"."longitude" AS "longitude", "int_ucl_teams"."european_rank" AS "european_rank", "int_ucl_teams"."ucl_rank" AS "ucl_rank" FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__2148090398" AS "int_ucl_teams" (base.py:2466)
2025-09-16 17:01:10,083 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-01 00:00:00, 2025-09-01 00:00:00) for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_team_snapshot": 401451744> (facade.py:622)
2025-09-16 17:01:10,083 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_team_snapshot": 401451744> (interval.py:214)
2025-09-16 17:01:10,406 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-09-16 17:01:10,406 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-16 17:01:10,981 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-09-16 17:01:11,176 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-09-16 17:01:11,182 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.snapshots' (evaluator.py:1360)
2025-09-16 17:01:11,182 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."snapshots" (base.py:2466)
2025-09-16 17:01:11,226 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.snapshots.ucl_squad_snapshot' to point at table 'champions_league_data.sqlmesh__snapshots.snapshots__ucl_squad_snapshot__67121484' (evaluator.py:1732)
2025-09-16 17:01:11,227 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:01:11,228 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:01:11,231 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'snapshots') AND table_name IN ('ucl_squad_snapshot') (base.py:2466)
2025-09-16 17:01:11,237 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ CREATE OR REPLACE VIEW "champions_league_data"."snapshots"."ucl_squad_snapshot" AS SELECT * FROM "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_squad_snapshot__67121484" (base.py:2466)
2025-09-16 17:01:11,335 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.snapshots.ucl_team_snapshot' to point at table 'champions_league_data.sqlmesh__snapshots.snapshots__ucl_team_snapshot__1765145592' (evaluator.py:1732)
2025-09-16 17:01:11,336 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:01:11,336 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:01:11,337 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'snapshots') AND table_name IN ('ucl_team_snapshot') (base.py:2466)
2025-09-16 17:01:11,340 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0807a930b7394a029e21976cd5e4651c */ CREATE OR REPLACE VIEW "champions_league_data"."snapshots"."ucl_team_snapshot" AS SELECT * FROM "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_team_snapshot__1765145592" (base.py:2466)
2025-09-16 17:01:11,445 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-09-16 17:01:11,445 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-09-16 17:01:11,538 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
