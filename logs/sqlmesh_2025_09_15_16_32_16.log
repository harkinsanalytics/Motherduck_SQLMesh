2025-09-15 16:32:17,139 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'md:champions_league_data'} (connection.py:489)
2025-09-15 16:32:17,528 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-09-15 16:32:17,528 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"champions_league_data"."sqlmesh_example"."full_model"' was not found at /Users/AaronHarkins/Python/SQLMesh_Motherduck/tests/test_full_model.yaml (console.py:2260)
2025-09-15 16:32:17,529 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: md:champions_league_data (connection.py:479)
2025-09-15 16:32:17,529 - MainThread - sqlmesh.core.console - WARNING - The motherduck engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-09-15 16:32:22,784 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-09-15 16:32:23,189 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-15 16:32:23,190 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__staging' (evaluator.py:1360)
2025-09-15 16:32:23,190 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__staging" (base.py:2466)
2025-09-15 16:32:23,232 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__intermediate' (evaluator.py:1360)
2025-09-15 16:32:23,232 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__intermediate" (base.py:2466)
2025-09-15 16:32:23,274 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-09-15 16:32:23,275 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__intermediate (evaluator.py:1463)
2025-09-15 16:32:23,276 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:32:23,276 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:32:23,278 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__intermediate') AND table_name IN ('intermediate__int_ucl_matches__2315805281', 'intermediate__int_ucl_teams__4282581205') (base.py:2466)
2025-09-15 16:32:23,295 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__staging (evaluator.py:1463)
2025-09-15 16:32:23,295 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:32:23,295 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:32:23,297 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_squads__1660759538', 'staging__stg_ucl_teams__1922017101', 'staging__stg_ucl_matches__1679965645') (base.py:2466)
2025-09-15 16:32:23,300 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-15 16:32:23,300 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-09-15 16:32:23,300 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-15 16:32:23,856 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage MigrateSchemasStage (evaluator.py:125)
2025-09-15 16:32:23,857 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__intermediate (evaluator.py:1463)
2025-09-15 16:32:23,857 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:32:23,857 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:32:23,858 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__intermediate') AND table_name IN ('intermediate__int_ucl_matches__2315805281') (base.py:2466)
2025-09-15 16:32:23,873 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_matches__2315805281_schema_tmp' (evaluator.py:1768)
2025-09-15 16:32:23,874 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:32:23,874 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 16:32:23,876 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ CREATE TABLE IF NOT EXISTS "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__2315805281_schema_tmp" AS SELECT "m"."competition_id" AS "competition_id", "m"."competition_name" AS "competition_name", "m"."competition_code" AS "competition_code", "m"."season_id" AS "season_id", "m"."season_start_date" AS "season_start_date", "m"."season_end_date" AS "season_end_date", "m"."season_current_matchday" AS "season_current_matchday", "m"."match_id" AS "match_id", "m"."match_datetime_est" AS "match_datetime_est", "m"."match_status" AS "match_status", "m"."matchday" AS "matchday", "m"."stage" AS "stage", "m"."group" AS "group", "m"."lastupdated" AS "lastupdated", "m"."hometeam_id" AS "hometeam_id", "m"."hometeam_name" AS "hometeam_name", "m"."hometeam_shortname" AS "hometeam_shortname", "m"."hometeam_tla" AS "hometeam_tla", "m"."awayteam_id" AS "awayteam_id", "m"."awayteam_name" AS "awayteam_name", "m"."awayteam_shortname" AS "awayteam_shortname", "m"."awayteam_tla" AS "awayteam_tla", "m"."score_winner" AS "score_winner", "m"."score_duration" AS "score_duration", "m"."score_fulltime_home" AS "score_fulltime_home", "m"."score_fulltime_away" AS "score_fulltime_away", "m"."score_halftime_home" AS "score_halftime_home", "m"."score_halftime_away" AS "score_halftime_away", "m"."referees" AS "referees", "t"."latitude" AS "hometeam_latitude", "t"."longitude" AS "hometeam_longitude", "tt"."latitude" AS "awayteam_latitude", "tt"."longitude" AS "awayteam_longitude", "t"."rank" AS "hometeam_rank", "tt"."rank" AS "awayteam_rank" FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__1679965645" AS "m" JOIN "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__4282581205" AS "t" ON "m"."hometeam_id" = "t"."team_id" JOIN "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__4282581205" AS "tt" ON "m"."awayteam_id" = "tt"."team_id" WHERE FALSE LIMIT 0 (base.py:2466)
2025-09-15 16:32:23,972 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Migrating table schema from 'champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_matches__2315805281_schema_tmp' to 'champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_matches__2315805281' (evaluator.py:1127)
2025-09-15 16:32:23,972 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Altering table 'champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_matches__2315805281' (evaluator.py:1817)
2025-09-15 16:32:23,973 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ DESCRIBE "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__2315805281" (base.py:2466)
2025-09-15 16:32:23,976 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ DESCRIBE "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__2315805281_schema_tmp" (base.py:2466)
2025-09-15 16:32:23,980 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ DROP TABLE IF EXISTS "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__2315805281_schema_tmp" (base.py:2466)
2025-09-15 16:32:24,080 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-09-15 16:32:24,224 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-09-15 16:32:24,229 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.intermediate' (evaluator.py:1360)
2025-09-15 16:32:24,229 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."intermediate" (base.py:2466)
2025-09-15 16:32:24,272 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.intermediate.int_ucl_matches' to point at table 'champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_matches__2315805281' (evaluator.py:1732)
2025-09-15 16:32:24,273 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:32:24,274 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 16:32:24,276 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'intermediate') AND table_name IN ('int_ucl_matches') (base.py:2466)
2025-09-15 16:32:24,281 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 02e37b3e488341248315114c8d63b932 */ CREATE OR REPLACE VIEW "champions_league_data"."intermediate"."int_ucl_matches" AS SELECT * FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__2315805281" (base.py:2466)
2025-09-15 16:32:24,377 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-09-15 16:32:24,377 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-09-15 16:32:24,470 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
