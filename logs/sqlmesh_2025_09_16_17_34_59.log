2025-09-16 17:34:59,615 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'md:champions_league_data'} (connection.py:489)
2025-09-16 17:35:00,207 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-09-16 17:35:00,207 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"champions_league_data"."sqlmesh_example"."full_model"' was not found at /Users/AaronHarkins/Python/SQLMesh_Motherduck/tests/test_full_model.yaml (console.py:2260)
2025-09-16 17:35:00,209 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: md:champions_league_data (connection.py:479)
2025-09-16 17:35:00,209 - MainThread - sqlmesh.core.console - WARNING - The motherduck engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-09-16 17:35:03,588 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-09-16 17:35:04,017 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-16 17:35:04,019 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__facts' (evaluator.py:1360)
2025-09-16 17:35:04,019 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__facts" (base.py:2466)
2025-09-16 17:35:04,061 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__staging' (evaluator.py:1360)
2025-09-16 17:35:04,061 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__staging" (base.py:2466)
2025-09-16 17:35:04,118 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__intermediate' (evaluator.py:1360)
2025-09-16 17:35:04,118 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__intermediate" (base.py:2466)
2025-09-16 17:35:04,160 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__snapshots' (evaluator.py:1360)
2025-09-16 17:35:04,160 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__snapshots" (base.py:2466)
2025-09-16 17:35:04,202 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-16 17:35:04,206 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__snapshots (evaluator.py:1463)
2025-09-16 17:35:04,206 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:04,208 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:04,210 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__snapshots') AND table_name IN ('snapshots__ucl_squad_snapshot__2525434465', 'snapshots__ucl_league_standings_snapshot__2157389774', 'snapshots__ucl_team_snapshot__3185020588') (base.py:2466)
2025-09-16 17:35:04,226 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__facts (evaluator.py:1463)
2025-09-16 17:35:04,226 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:04,226 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:04,227 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__facts') AND table_name IN ('facts__fct_ucl_league_standings__2293620651') (base.py:2466)
2025-09-16 17:35:04,231 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 3946330148> (evaluator.py:701)
2025-09-16 17:35:04,231 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 3946330148> (evaluator.py:910)
2025-09-16 17:35:04,263 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-05 00:00:00, 2025-09-11 00:00:00) into champions_league_data.sqlmesh__facts.facts__fct_ucl_league_standings__2293620651' (evaluator.py:940)
2025-09-16 17:35:04,263 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ DESCRIBE "champions_league_data"."sqlmesh__facts"."facts__fct_ucl_league_standings__2293620651" (base.py:2466)
2025-09-16 17:35:04,351 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:04,351 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:04,352 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__facts') AND table_name IN ('facts__fct_ucl_league_standings__2293620651') (base.py:2466)
2025-09-16 17:35:04,357 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:04,357 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-16 17:35:04,362 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__facts"."facts__fct_ucl_league_standings__2293620651" AS WITH "hometeam" AS (SELECT "int_ucl_matches"."match_id" AS "match_id", "int_ucl_matches"."match_status" AS "match_status", "int_ucl_matches"."matchday" AS "matchday", "int_ucl_matches"."season_current_matchday" AS "season_current_matchday", "int_ucl_matches"."hometeam_id" AS "team_id", "int_ucl_matches"."hometeam_tla" AS "team_tla", 'HOME_TEAM' AS "home_away", "int_ucl_matches"."score_fulltime_home" AS "score_fulltime", "int_ucl_matches"."score_halftime_home" AS "score_halftime", "int_ucl_matches"."score_winner" AS "score_winner" FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__3192354904" AS "int_ucl_matches" WHERE "int_ucl_matches"."stage" = 'LEAGUE_STAGE'), "awayteam" AS (SELECT "int_ucl_matches"."match_id" AS "match_id", "int_ucl_matches"."match_status" AS "match_status", "int_ucl_matches"."matchday" AS "matchday", "int_ucl_matches"."season_current_matchday" AS "season_current_matchday", "int_ucl_matches"."awayteam_id" AS "team_id", "int_ucl_matches"."awayteam_tla" AS "team_tla", 'AWAY_TEAM' AS "home_away", "int_ucl_matches"."score_fulltime_away" AS "score_fulltime", "int_ucl_matches"."score_halftime_away" AS "score_halftime", "int_ucl_matches"."score_winner" AS "score_winner" FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__3192354904" AS "int_ucl_matches" WHERE "int_ucl_matches"."stage" = 'LEAGUE_STAGE'), "unioned_data" AS (SELECT "hometeam"."match_id" AS "match_id", "hometeam"."match_status" AS "match_status", "hometeam"."matchday" AS "matchday", "hometeam"."season_current_matchday" AS "season_current_matchday", "hometeam"."team_id" AS "team_id", "hometeam"."team_tla" AS "team_tla", "hometeam"."home_away" AS "home_away", "hometeam"."score_fulltime" AS "score_fulltime", "hometeam"."score_halftime" AS "score_halftime", "hometeam"."score_winner" AS "score_winner" FROM "hometeam" AS "hometeam" UNION ALL SELECT "awayteam"."match_id" AS "match_id", "awayteam"."match_status" AS "match_status", "awayteam"."matchday" AS "matchday", "awayteam"."season_current_matchday" AS "season_current_matchday", "awayteam"."team_id" AS "team_id", "awayteam"."team_tla" AS "team_tla", "awayteam"."home_away" AS "home_away", "awayteam"."score_fulltime" AS "score_fulltime", "awayteam"."score_halftime" AS "score_halftime", "awayteam"."score_winner" AS "score_winner" FROM "awayteam" AS "awayteam"), "points" AS (SELECT "ud"."match_id" AS "match_id", "ud"."matchday" AS "matchday", "ud"."team_id" AS "team_id", "ud"."team_tla" AS "team_tla", "t"."team_name" AS "team_name", "ud"."home_away" AS "home_away", "ud"."score_fulltime" AS "score_fulltime", "ud"."score_winner" AS "score_winner", "ud"."match_status" AS "match_status", SUM(CAST("ud"."score_halftime" AS INT)) OVER (PARTITION BY "ud"."team_id" ORDER BY "ud"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "halftime_goals_scored", SUM(CAST("ud"."score_fulltime" AS INT)) OVER (PARTITION BY "ud"."team_id" ORDER BY "ud"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "total_goals_scored", CASE WHEN "ud"."home_away" = "ud"."score_winner" THEN 3 WHEN "ud"."score_winner" = 'DRAW' THEN 1 ELSE 0 END AS "points_earned" FROM "unioned_data" AS "ud" LEFT JOIN "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__2148090398" AS "t" ON "t"."team_id" = "ud"."team_id"), "goals_conceded" AS (SELECT "p"."match_id" AS "match_id", "p"."matchday" AS "matchday", "p"."team_id" AS "team_id", "p"."team_tla" AS "team_tla", "p"."team_name" AS "team_name", "p"."home_away" AS "home_away", "p"."score_fulltime" AS "score_fulltime", "p"."score_winner" AS "score_winner", "p"."match_status" AS "match_status", "p"."halftime_goals_scored" AS "halftime_goals_scored", "p"."total_goals_scored" AS "total_goals_scored", "p"."points_earned" AS "points_earned", SUM(CAST("p"."points_earned" AS INT)) OVER (PARTITION BY "p"."team_id" ORDER BY "p"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "total_points_earned", "pp"."score_fulltime" AS "goals_conceded", SUM(CAST("pp"."score_fulltime" AS INT)) OVER (PARTITION BY "p"."team_id" ORDER BY "p"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "total_goals_conceded" FROM "points" AS "p" JOIN "points" AS "pp" ON "p"."match_id" = "pp"."match_id" AND "p"."team_id" <> "pp"."team_id") SELECT "goals_conceded"."matchday" AS "matchday", "goals_conceded"."match_status" AS "match_status", "goals_conceded"."team_tla" AS "team_tla", "goals_conceded"."team_name" AS "team_name", "goals_conceded"."total_points_earned" AS "total_points_earned", "goals_conceded"."total_goals_scored" AS "total_goals_scored", "goals_conceded"."total_goals_conceded" AS "total_goals_conceded", "goals_conceded"."total_goals_scored" - "goals_conceded"."total_goals_conceded" AS "goal_differential", MAX("goals_conceded"."matchday") OVER (ORDER BY "goals_conceded"."matchday" DESC) AS "max_matchday" FROM "goals_conceded" AS "goals_conceded" WHERE "goals_conceded"."match_status" = 'FINISHED' ORDER BY "matchday", "team_name" DESC, "total_goals_conceded" DESC, "total_points_earned" DESC, "team_tla" (base.py:2466)
2025-09-16 17:35:04,498 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-05 00:00:00, 2025-09-11 00:00:00) for snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 3946330148> (facade.py:622)
2025-09-16 17:35:04,498 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 3946330148> (interval.py:214)
2025-09-16 17:35:04,794 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_league_standings_snapshot": 1900933935> (evaluator.py:701)
2025-09-16 17:35:04,794 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_league_standings_snapshot": 1900933935> (evaluator.py:910)
2025-09-16 17:35:04,798 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-05 00:00:00, 2025-09-11 00:00:00) into champions_league_data.sqlmesh__snapshots.snapshots__ucl_league_standings_snapshot__2157389774' (evaluator.py:940)
2025-09-16 17:35:04,798 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ DESCRIBE "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_league_standings_snapshot__2157389774" (base.py:2466)
2025-09-16 17:35:04,878 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:04,879 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:04,880 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__snapshots') AND table_name IN ('snapshots__ucl_league_standings_snapshot__2157389774') (base.py:2466)
2025-09-16 17:35:04,884 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:04,885 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-16 17:35:04,886 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_league_standings_snapshot__2157389774" AS SELECT CURRENT_DATE AS "snapshot_date", "stg_ucl_squads"."team_id" AS "team_id", "stg_ucl_squads"."team_name" AS "team_name", "stg_ucl_squads"."player_id" AS "player_id", "stg_ucl_squads"."player_name" AS "player_name", "stg_ucl_squads"."position" AS "position", "stg_ucl_squads"."date_of_birth" AS "date_of_birth", "stg_ucl_squads"."nationality" AS "nationality" FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_squads__1660759538" AS "stg_ucl_squads" (base.py:2466)
2025-09-16 17:35:04,999 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-05 00:00:00, 2025-09-11 00:00:00) for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_league_standings_snapshot": 1900933935> (facade.py:622)
2025-09-16 17:35:05,000 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_league_standings_snapshot": 1900933935> (interval.py:214)
2025-09-16 17:35:05,316 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_squad_snapshot": 1844639733> (evaluator.py:701)
2025-09-16 17:35:05,316 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_squad_snapshot": 1844639733> (evaluator.py:910)
2025-09-16 17:35:05,320 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-01 00:00:00, 2025-09-01 00:00:00) into champions_league_data.sqlmesh__snapshots.snapshots__ucl_squad_snapshot__2525434465' (evaluator.py:940)
2025-09-16 17:35:05,320 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ DESCRIBE "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_squad_snapshot__2525434465" (base.py:2466)
2025-09-16 17:35:05,321 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:05,321 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:05,322 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__snapshots') AND table_name IN ('snapshots__ucl_squad_snapshot__2525434465') (base.py:2466)
2025-09-16 17:35:05,326 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:05,327 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-16 17:35:05,328 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_squad_snapshot__2525434465" AS SELECT CAST("snapshot_date" AS DATE) AS "snapshot_date", CAST("team_id" AS TEXT) AS "team_id", CAST("team_name" AS TEXT) AS "team_name", CAST("player_id" AS TEXT) AS "player_id", CAST("player_name" AS TEXT) AS "player_name", CAST("position" AS TEXT) AS "position", CAST("date_of_birth" AS TEXT) AS "date_of_birth", CAST("nationality" AS TEXT) AS "nationality" FROM (SELECT CURRENT_DATE AS "snapshot_date", "stg_ucl_squads"."team_id" AS "team_id", "stg_ucl_squads"."team_name" AS "team_name", "stg_ucl_squads"."player_id" AS "player_id", "stg_ucl_squads"."player_name" AS "player_name", "stg_ucl_squads"."position" AS "position", "stg_ucl_squads"."date_of_birth" AS "date_of_birth", "stg_ucl_squads"."nationality" AS "nationality" FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_squads__1660759538" AS "stg_ucl_squads") AS "_subquery" (base.py:2466)
2025-09-16 17:35:05,451 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-01 00:00:00, 2025-09-01 00:00:00) for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_squad_snapshot": 1844639733> (facade.py:622)
2025-09-16 17:35:05,451 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_squad_snapshot": 1844639733> (interval.py:214)
2025-09-16 17:35:05,765 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_team_snapshot": 1446165300> (evaluator.py:701)
2025-09-16 17:35:05,765 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_team_snapshot": 1446165300> (evaluator.py:910)
2025-09-16 17:35:05,776 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-01 00:00:00, 2025-09-01 00:00:00) into champions_league_data.sqlmesh__snapshots.snapshots__ucl_team_snapshot__3185020588' (evaluator.py:940)
2025-09-16 17:35:05,776 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ DESCRIBE "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_team_snapshot__3185020588" (base.py:2466)
2025-09-16 17:35:05,779 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:05,779 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:05,781 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__snapshots') AND table_name IN ('snapshots__ucl_team_snapshot__3185020588') (base.py:2466)
2025-09-16 17:35:05,787 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:05,788 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-16 17:35:05,790 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_team_snapshot__3185020588" AS SELECT CAST("snapshot_date" AS DATE) AS "snapshot_date", CAST("area_name" AS TEXT) AS "area_name", CAST("team_id" AS TEXT) AS "team_id", CAST("team_name" AS TEXT) AS "team_name", CAST("team_short_name" AS TEXT) AS "team_short_name", CAST("team_tla" AS TEXT) AS "team_tla", CAST("team_address" AS TEXT) AS "team_address", CAST("team_venue" AS TEXT) AS "team_venue", CAST("coach_id" AS TEXT) AS "coach_id", CAST("coach_first_name" AS TEXT) AS "coach_first_name", CAST("coach_last_name" AS TEXT) AS "coach_last_name", CAST("coach_name" AS TEXT) AS "coach_name", CAST("coach_nationality" AS TEXT) AS "coach_nationality", CAST("coach_contract_start" AS TEXT) AS "coach_contract_start", CAST("coach_contract_until" AS TEXT) AS "coach_contract_until", CAST("lastupdated" AS TEXT) AS "lastupdated", CAST("latitude" AS TEXT) AS "latitude", CAST("longitude" AS TEXT) AS "longitude", CAST("european_rank" AS BIGINT) AS "european_rank", CAST("ucl_rank" AS BIGINT) AS "ucl_rank" FROM (SELECT CURRENT_DATE AS "snapshot_date", "int_ucl_teams"."area_name" AS "area_name", "int_ucl_teams"."team_id" AS "team_id", "int_ucl_teams"."team_name" AS "team_name", "int_ucl_teams"."team_short_name" AS "team_short_name", "int_ucl_teams"."team_tla" AS "team_tla", "int_ucl_teams"."team_address" AS "team_address", "int_ucl_teams"."team_venue" AS "team_venue", "int_ucl_teams"."coach_id" AS "coach_id", "int_ucl_teams"."coach_first_name" AS "coach_first_name", "int_ucl_teams"."coach_last_name" AS "coach_last_name", "int_ucl_teams"."coach_name" AS "coach_name", "int_ucl_teams"."coach_nationality" AS "coach_nationality", "int_ucl_teams"."coach_contract_start" AS "coach_contract_start", "int_ucl_teams"."coach_contract_until" AS "coach_contract_until", "int_ucl_teams"."lastupdated" AS "lastupdated", "int_ucl_teams"."latitude" AS "latitude", "int_ucl_teams"."longitude" AS "longitude", "int_ucl_teams"."european_rank" AS "european_rank", "int_ucl_teams"."ucl_rank" AS "ucl_rank" FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__2148090398" AS "int_ucl_teams") AS "_subquery" (base.py:2466)
2025-09-16 17:35:05,908 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-01 00:00:00, 2025-09-01 00:00:00) for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_team_snapshot": 1446165300> (facade.py:622)
2025-09-16 17:35:05,909 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_team_snapshot": 1446165300> (interval.py:214)
2025-09-16 17:35:06,234 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-09-16 17:35:06,235 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-16 17:35:06,819 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-09-16 17:35:06,991 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-09-16 17:35:06,996 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.facts' (evaluator.py:1360)
2025-09-16 17:35:07,000 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."facts" (base.py:2466)
2025-09-16 17:35:07,042 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.snapshots' (evaluator.py:1360)
2025-09-16 17:35:07,043 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."snapshots" (base.py:2466)
2025-09-16 17:35:07,087 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.facts.fct_ucl_league_standings' to point at table 'champions_league_data.sqlmesh__facts.facts__fct_ucl_league_standings__2293620651' (evaluator.py:1732)
2025-09-16 17:35:07,088 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:07,089 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:07,091 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'facts') AND table_name IN ('fct_ucl_league_standings') (base.py:2466)
2025-09-16 17:35:07,100 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE OR REPLACE VIEW "champions_league_data"."facts"."fct_ucl_league_standings" AS SELECT * FROM "champions_league_data"."sqlmesh__facts"."facts__fct_ucl_league_standings__2293620651" (base.py:2466)
2025-09-16 17:35:07,204 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.snapshots.ucl_league_standings_snapshot' to point at table 'champions_league_data.sqlmesh__snapshots.snapshots__ucl_league_standings_snapshot__2157389774' (evaluator.py:1732)
2025-09-16 17:35:07,204 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:07,205 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 17:35:07,206 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'snapshots') AND table_name IN ('ucl_league_standings_snapshot') (base.py:2466)
2025-09-16 17:35:07,210 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f2f8870730b84bf98c2ad59cc101f98d */ CREATE OR REPLACE VIEW "champions_league_data"."snapshots"."ucl_league_standings_snapshot" AS SELECT * FROM "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_league_standings_snapshot__2157389774" (base.py:2466)
2025-09-16 17:35:07,313 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-09-16 17:35:07,313 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-09-16 17:35:07,419 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
