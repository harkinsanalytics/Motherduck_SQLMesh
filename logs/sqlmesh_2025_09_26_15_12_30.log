2025-09-26 15:12:30,923 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'md:champions_league_data'} (connection.py:491)
2025-09-26 15:12:31,337 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:493)
2025-09-26 15:12:31,338 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"champions_league_data"."sqlmesh_example"."full_model"' was not found at /Users/AaronHarkins/Python/SQLMesh_Motherduck/tests/test_full_model.yaml (console.py:2335)
2025-09-26 15:12:31,339 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: md:champions_league_data (connection.py:481)
2025-09-26 15:12:31,339 - MainThread - sqlmesh.core.console - WARNING - The motherduck engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2335)
2025-09-26 15:12:34,774 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:123)
2025-09-26 15:12:35,223 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2025-09-26 15:12:35,237 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__intermediate' (evaluator.py:1374)
2025-09-26 15:12:35,238 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__intermediate" (base.py:2498)
2025-09-26 15:12:35,351 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__staging' (evaluator.py:1374)
2025-09-26 15:12:35,351 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__staging" (base.py:2498)
2025-09-26 15:12:35,457 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__facts' (evaluator.py:1374)
2025-09-26 15:12:35,457 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__facts" (base.py:2498)
2025-09-26 15:12:35,514 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__snapshots' (evaluator.py:1374)
2025-09-26 15:12:35,515 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__snapshots" (base.py:2498)
2025-09-26 15:12:35,557 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2025-09-26 15:12:35,561 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__snapshots (evaluator.py:1477)
2025-09-26 15:12:35,561 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:35,562 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:35,564 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__snapshots') AND table_name IN ('snapshots__ucl_matches_snapshot__163009497') (base.py:2498)
2025-09-26 15:12:35,582 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__intermediate (evaluator.py:1477)
2025-09-26 15:12:35,583 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:35,583 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:35,584 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__intermediate') AND table_name IN ('intermediate__int_ucl_matches__2132675639') (base.py:2498)
2025-09-26 15:12:35,588 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__facts (evaluator.py:1477)
2025-09-26 15:12:35,588 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:35,588 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:35,589 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__facts') AND table_name IN ('facts__fct_ucl_league_standings__4264540505') (base.py:2498)
2025-09-26 15:12:35,593 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_matches": 546484152> (evaluator.py:700)
2025-09-26 15:12:35,593 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_matches": 546484152> (evaluator.py:909)
2025-09-26 15:12:35,603 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-24 00:00:00, 2025-09-26 00:00:00) into champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_matches__2132675639' (evaluator.py:939)
2025-09-26 15:12:35,603 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ DESCRIBE "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__2132675639" (base.py:2498)
2025-09-26 15:12:35,688 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:35,689 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:35,690 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__intermediate') AND table_name IN ('intermediate__int_ucl_matches__2132675639') (base.py:2498)
2025-09-26 15:12:35,693 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:35,694 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2498)
2025-09-26 15:12:35,696 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__2132675639" AS WITH "t1" AS (SELECT "m"."competition_id", "m"."competition_name", "m"."competition_code", "m"."season_id", "m"."season_start_date", "m"."season_end_date", "m"."season_current_matchday", "m"."match_id", "m"."match_datetime_est", CAST("m"."match_datetime_est" AS DATE) AS "match_date", CAST(DATE_TRUNC('WEEK', "m"."match_datetime_est") AS DATE) AS "match_week", "m"."match_status", "m"."matchday", "m"."stage", "m"."group", "m"."hometeam_id", "m"."hometeam_name", "m"."hometeam_shortname", "m"."hometeam_tla", "m"."awayteam_id", "m"."awayteam_name", "m"."awayteam_shortname", "m"."awayteam_tla", "m"."score_winner", "m"."score_duration", "m"."score_fulltime_home", "m"."score_fulltime_away", "m"."score_halftime_home", "m"."score_halftime_away", "m"."referees", DENSE_RANK() OVER (ORDER BY CAST(DATE_TRUNC('WEEK', "m"."match_datetime_est") AS DATE)) AS "match_week_rank", DENSE_RANK() OVER (PARTITION BY "m"."match_status" ORDER BY CAST(DATE_TRUNC('WEEK', "m"."match_datetime_est") AS DATE)) AS "match_status_week_rank", "l"."latitude" AS "hometeam_latitude", "l"."longitude" AS "hometeam_longitude", "ll"."latitude" AS "awayteam_latitude", "ll"."longitude" AS "awayteam_longitude", "t"."european_rank" AS "hometeam_european_rank", "tt"."european_rank" AS "awayteam_european_rank", "t"."ucl_rank" AS "hometeam_ucl_rank", "tt"."ucl_rank" AS "awayteam_ucl_rank" FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__2043582137" AS "m" LEFT JOIN "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__1292453979" AS "t" ON "m"."hometeam_id" = "t"."team_id" LEFT JOIN "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__1292453979" AS "tt" ON "m"."awayteam_id" = "tt"."team_id" LEFT JOIN "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__3331770713" AS "l" ON "m"."hometeam_id" = "l"."team_id" LEFT JOIN "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__3331770713" AS "ll" ON "m"."awayteam_id" = "ll"."team_id"), "travel_distance" AS (SELECT *, ROUND(3959 * 2 * ASIN(SQRT(POWER(SIN(RADIANS("awayteam_latitude" - "hometeam_latitude") / 2), 2) + COS(RADIANS("hometeam_latitude")) * COS(RADIANS("awayteam_latitude")) * POWER(SIN(RADIANS("awayteam_longitude" - "hometeam_longitude") / 2), 2))), 2) AS "distance_in_miles", MAX("match_date") OVER (PARTITION BY "matchday", "stage" ORDER BY "match_date" DESC) AS "last_match" FROM "t1" AS "t1") SELECT "td".* EXCLUDE ("last_match"), "last_match" AS "week_ending_date" FROM "travel_distance" AS "td" (base.py:2498)
2025-09-26 15:12:35,852 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-24 00:00:00, 2025-09-26 00:00:00) for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_matches": 546484152> (facade.py:623)
2025-09-26 15:12:35,852 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_matches": 546484152> (interval.py:214)
2025-09-26 15:12:36,185 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 428910763> (evaluator.py:700)
2025-09-26 15:12:36,185 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 428910763> (evaluator.py:909)
2025-09-26 15:12:36,197 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-24 00:00:00, 2025-09-26 00:00:00) into champions_league_data.sqlmesh__facts.facts__fct_ucl_league_standings__4264540505' (evaluator.py:939)
2025-09-26 15:12:36,198 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ DESCRIBE "champions_league_data"."sqlmesh__facts"."facts__fct_ucl_league_standings__4264540505" (base.py:2498)
2025-09-26 15:12:36,287 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:36,288 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:36,290 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__facts') AND table_name IN ('facts__fct_ucl_league_standings__4264540505') (base.py:2498)
2025-09-26 15:12:36,297 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:36,299 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2498)
2025-09-26 15:12:36,314 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__facts"."facts__fct_ucl_league_standings__4264540505" AS WITH "hometeam" AS (SELECT "match_id", "match_status", "matchday", "season_current_matchday", "hometeam_id" AS "team_id", "hometeam_tla" AS "team_tla", 'HOME_TEAM' AS "home_away", "score_fulltime_home" AS "score_fulltime", "score_halftime_home" AS "score_halftime", "score_winner" FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__2132675639" AS "int_ucl_matches" WHERE 1 = 1 AND "stage" = 'LEAGUE_STAGE'), "awayteam" AS (SELECT "match_id", "match_status", "matchday", "season_current_matchday", "awayteam_id" AS "team_id", "awayteam_tla" AS "team_tla", 'AWAY_TEAM' AS "home_away", "score_fulltime_away" AS "score_fulltime", "score_halftime_away" AS "score_halftime", "score_winner" FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__2132675639" AS "int_ucl_matches" WHERE 1 = 1 AND "stage" = 'LEAGUE_STAGE'), "unioned_data" AS (SELECT * FROM "hometeam" AS "hometeam" UNION ALL SELECT * FROM "awayteam" AS "awayteam"), "points" AS (SELECT "ud"."match_id", "ud"."matchday", "ud"."team_id", "ud"."team_tla", "t"."team_name" AS "team_name", "ud"."home_away", "ud"."score_fulltime", "ud"."score_winner", "ud"."match_status", SUM(CAST("ud"."score_halftime" AS INT)) OVER (PARTITION BY "ud"."team_id" ORDER BY "ud"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "halftime_goals_scored", SUM(CAST("ud"."score_fulltime" AS INT)) OVER (PARTITION BY "ud"."team_id" ORDER BY "ud"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "total_goals_scored", CASE WHEN "ud"."score_winner" = "ud"."home_away" THEN 3 WHEN "ud"."score_winner" = 'DRAW' THEN 1 ELSE 0 END AS "points_earned" FROM "unioned_data" AS "ud" LEFT JOIN "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__1292453979" AS "t" ON "ud"."team_id" = "t"."team_id" WHERE 1 = 1), "goals_conceded" AS (SELECT "p".*, SUM(CAST("p"."points_earned" AS INT)) OVER (PARTITION BY "p"."team_id" ORDER BY "p"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "total_points_earned", "pp"."score_fulltime" AS "goals_conceded", SUM(CAST("pp"."score_fulltime" AS INT)) OVER (PARTITION BY "p"."team_id" ORDER BY "p"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "total_goals_conceded" FROM "points" AS "p" JOIN "points" AS "pp" ON "p"."match_id" = "pp"."match_id" AND "p"."team_id" <> "pp"."team_id"), "matches" AS (SELECT "matchday", "match_status", "team_tla", "team_name", "total_points_earned", "total_goals_scored", "total_goals_conceded", ("total_goals_scored" - "total_goals_conceded") AS "goal_differential", MAX("matchday") OVER (ORDER BY "matchday" DESC) AS "max_matchday" FROM "goals_conceded" AS "goals_conceded" WHERE 1 = 1 AND "match_status" = 'FINISHED') SELECT *, CASE WHEN "max_matchday" = "matchday" THEN 1 ELSE 0 END AS "current_matchday" FROM "matches" AS "matches" ORDER BY 1, 5 DESC, 8 DESC, 6 DESC, 4 (base.py:2498)
2025-09-26 15:12:36,463 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-24 00:00:00, 2025-09-26 00:00:00) for snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 428910763> (facade.py:623)
2025-09-26 15:12:36,464 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 428910763> (interval.py:214)
2025-09-26 15:12:36,826 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_matches_snapshot": 3677387006> (evaluator.py:700)
2025-09-26 15:12:36,827 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_matches_snapshot": 3677387006> (evaluator.py:909)
2025-09-26 15:12:36,831 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-15 00:00:00, 2025-09-26 00:00:00) into champions_league_data.sqlmesh__snapshots.snapshots__ucl_matches_snapshot__163009497' (evaluator.py:939)
2025-09-26 15:12:36,831 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ DESCRIBE "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_matches_snapshot__163009497" (base.py:2498)
2025-09-26 15:12:36,932 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:36,933 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:36,935 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__snapshots') AND table_name IN ('snapshots__ucl_matches_snapshot__163009497') (base.py:2498)
2025-09-26 15:12:36,941 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:36,944 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2498)
2025-09-26 15:12:36,948 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_matches_snapshot__163009497" AS SELECT CURRENT_DATE AS "snapshot_date", "competition_id" AS "competition_id", "competition_name" AS "competition_name", "competition_code" AS "competition_code", "season_id" AS "season_id", "season_start_date" AS "season_start_date", "season_end_date" AS "season_end_date", "season_current_matchday" AS "season_current_matchday", "match_id" AS "match_id", "match_datetime_est" AS "match_datetime_est", "match_status" AS "match_status", "matchday" AS "matchday", "stage" AS "stage", "group" AS "group", "hometeam_id" AS "hometeam_id", "hometeam_name" AS "hometeam_name", "hometeam_shortname" AS "hometeam_shortname", "hometeam_tla" AS "hometeam_tla", "awayteam_id" AS "awayteam_id", "awayteam_name" AS "awayteam_name", "awayteam_shortname" AS "awayteam_shortname", "awayteam_tla" AS "awayteam_tla", "score_winner" AS "score_winner", "score_duration" AS "score_duration", "score_fulltime_home" AS "score_fulltime_home", "score_fulltime_away" AS "score_fulltime_away", "score_halftime_home" AS "score_halftime_home", "score_halftime_away" AS "score_halftime_away", "referees" AS "referees", "hometeam_latitude" AS "hometeam_latitude", "hometeam_longitude" AS "hometeam_longitude", "awayteam_latitude" AS "awayteam_latitude", "awayteam_longitude" AS "awayteam_longitude", "hometeam_european_rank" AS "hometeam_european_rank", "awayteam_european_rank" AS "awayteam_european_rank", "hometeam_ucl_rank" AS "hometeam_ucl_rank", "awayteam_ucl_rank" AS "awayteam_ucl_rank", "distance_in_miles" AS "distance_in_miles", "week_ending_date" AS "week_ending_date" FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__2132675639" AS "int_ucl_matches" WHERE 1 = 1 AND "match_status" = 'FINISHED' AND "match_datetime_est" < CURRENT_DATE (base.py:2498)
2025-09-26 15:12:37,059 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-15 00:00:00, 2025-09-26 00:00:00) for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_matches_snapshot": 3677387006> (facade.py:623)
2025-09-26 15:12:37,059 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_matches_snapshot": 3677387006> (interval.py:214)
2025-09-26 15:12:37,391 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:123)
2025-09-26 15:12:37,391 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:166)
2025-09-26 15:12:38,043 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:123)
2025-09-26 15:12:38,224 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:123)
2025-09-26 15:12:38,230 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.snapshots' (evaluator.py:1374)
2025-09-26 15:12:38,230 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."snapshots" (base.py:2498)
2025-09-26 15:12:38,272 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.intermediate' (evaluator.py:1374)
2025-09-26 15:12:38,272 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."intermediate" (base.py:2498)
2025-09-26 15:12:38,430 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.facts' (evaluator.py:1374)
2025-09-26 15:12:38,431 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."facts" (base.py:2498)
2025-09-26 15:12:38,486 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.intermediate.int_ucl_matches' to point at table 'champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_matches__2132675639' (evaluator.py:1746)
2025-09-26 15:12:38,488 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:38,490 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:38,493 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'intermediate') AND table_name IN ('int_ucl_matches') (base.py:2498)
2025-09-26 15:12:38,502 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE OR REPLACE VIEW "champions_league_data"."intermediate"."int_ucl_matches" AS SELECT * FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__2132675639" (base.py:2498)
2025-09-26 15:12:38,625 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.facts.fct_ucl_league_standings' to point at table 'champions_league_data.sqlmesh__facts.facts__fct_ucl_league_standings__4264540505' (evaluator.py:1746)
2025-09-26 15:12:38,625 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:38,626 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:38,627 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'facts') AND table_name IN ('fct_ucl_league_standings') (base.py:2498)
2025-09-26 15:12:38,630 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE OR REPLACE VIEW "champions_league_data"."facts"."fct_ucl_league_standings" AS SELECT * FROM "champions_league_data"."sqlmesh__facts"."facts__fct_ucl_league_standings__4264540505" (base.py:2498)
2025-09-26 15:12:38,771 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.snapshots.ucl_matches_snapshot' to point at table 'champions_league_data.sqlmesh__snapshots.snapshots__ucl_matches_snapshot__163009497' (evaluator.py:1746)
2025-09-26 15:12:38,772 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:38,772 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-26 15:12:38,773 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'snapshots') AND table_name IN ('ucl_matches_snapshot') (base.py:2498)
2025-09-26 15:12:38,776 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 471aebc17e6345abbb575b8f289115f5 */ CREATE OR REPLACE VIEW "champions_league_data"."snapshots"."ucl_matches_snapshot" AS SELECT * FROM "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_matches_snapshot__163009497" (base.py:2498)
2025-09-26 15:12:38,937 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:123)
2025-09-26 15:12:38,937 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-09-26 15:12:39,046 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
