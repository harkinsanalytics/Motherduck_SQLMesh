2025-09-15 20:14:22,317 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'md:champions_league_data'} (connection.py:489)
2025-09-15 20:14:22,723 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-09-15 20:14:22,724 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"champions_league_data"."sqlmesh_example"."full_model"' was not found at /Users/AaronHarkins/Python/SQLMesh_Motherduck/tests/test_full_model.yaml (console.py:2260)
2025-09-15 20:14:22,725 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: md:champions_league_data (connection.py:479)
2025-09-15 20:14:22,725 - MainThread - sqlmesh.core.console - WARNING - The motherduck engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-09-15 20:14:24,293 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0000_baseline' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0000_baseline.py'> (migrator.py:186)
2025-09-15 20:14:24,915 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0061_mysql_fix_blob_text_type' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0061_mysql_fix_blob_text_type.py'> (migrator.py:186)
2025-09-15 20:14:24,915 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0062_add_model_gateway' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0062_add_model_gateway.py'> (migrator.py:186)
2025-09-15 20:14:24,915 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0063_change_signals' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0063_change_signals.py'> (migrator.py:186)
2025-09-15 20:14:24,915 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0064_join_when_matched_strings' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0064_join_when_matched_strings.py'> (migrator.py:186)
2025-09-15 20:14:24,915 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0065_add_model_optimize' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0065_add_model_optimize.py'> (migrator.py:186)
2025-09-15 20:14:24,915 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0066_add_auto_restatements' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0066_add_auto_restatements.py'> (migrator.py:186)
2025-09-15 20:14:25,129 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0067_add_tsql_date_full_precision' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0067_add_tsql_date_full_precision.py'> (migrator.py:186)
2025-09-15 20:14:25,130 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0068_include_unrendered_query_in_metadata_hash' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0068_include_unrendered_query_in_metadata_hash.py'> (migrator.py:186)
2025-09-15 20:14:25,130 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0069_update_dev_table_suffix' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0069_update_dev_table_suffix.py'> (migrator.py:186)
2025-09-15 20:14:25,131 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0070_include_grains_in_metadata_hash' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0070_include_grains_in_metadata_hash.py'> (migrator.py:186)
2025-09-15 20:14:25,131 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0071_add_dev_version_to_intervals' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0071_add_dev_version_to_intervals.py'> (migrator.py:186)
2025-09-15 20:14:25,232 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0072_add_environment_statements' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0072_add_environment_statements.py'> (migrator.py:186)
2025-09-15 20:14:25,340 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0073_remove_symbolic_disable_restatement' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0073_remove_symbolic_disable_restatement.py'> (migrator.py:186)
2025-09-15 20:14:25,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0074_add_partition_by_time_column_property' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0074_add_partition_by_time_column_property.py'> (migrator.py:186)
2025-09-15 20:14:25,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0075_remove_validate_query' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0075_remove_validate_query.py'> (migrator.py:186)
2025-09-15 20:14:25,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0076_add_cron_tz' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0076_add_cron_tz.py'> (migrator.py:186)
2025-09-15 20:14:25,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0077_fix_column_type_hash_calculation' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0077_fix_column_type_hash_calculation.py'> (migrator.py:186)
2025-09-15 20:14:25,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0078_warn_if_non_migratable_python_env' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0078_warn_if_non_migratable_python_env.py'> (migrator.py:186)
2025-09-15 20:14:25,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0079_add_gateway_managed_property' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0079_add_gateway_managed_property.py'> (migrator.py:186)
2025-09-15 20:14:25,456 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0080_add_batch_size_to_scd_type_2_models' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0080_add_batch_size_to_scd_type_2_models.py'> (migrator.py:186)
2025-09-15 20:14:25,456 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0081_update_partitioned_by' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0081_update_partitioned_by.py'> (migrator.py:186)
2025-09-15 20:14:25,456 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0082_warn_if_incorrectly_duplicated_statements' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0082_warn_if_incorrectly_duplicated_statements.py'> (migrator.py:186)
2025-09-15 20:14:25,456 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0083_use_sql_for_scd_time_data_type_data_hash' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0083_use_sql_for_scd_time_data_type_data_hash.py'> (migrator.py:186)
2025-09-15 20:14:25,456 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0084_normalize_quote_when_matched_and_merge_filter' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0084_normalize_quote_when_matched_and_merge_filter.py'> (migrator.py:186)
2025-09-15 20:14:25,456 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0085_deterministic_repr' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0085_deterministic_repr.py'> (migrator.py:186)
2025-09-15 20:14:25,456 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0086_check_deterministic_bug' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0086_check_deterministic_bug.py'> (migrator.py:186)
2025-09-15 20:14:25,456 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0087_normalize_blueprint_variables' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0087_normalize_blueprint_variables.py'> (migrator.py:186)
2025-09-15 20:14:25,456 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0088_warn_about_variable_python_env_diffs' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0088_warn_about_variable_python_env_diffs.py'> (migrator.py:186)
2025-09-15 20:14:25,456 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0089_add_virtual_environment_mode' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0089_add_virtual_environment_mode.py'> (migrator.py:186)
2025-09-15 20:14:25,456 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0090_add_forward_only_column' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0090_add_forward_only_column.py'> (migrator.py:186)
2025-09-15 20:14:25,559 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0091_on_additive_change' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0091_on_additive_change.py'> (migrator.py:186)
2025-09-15 20:14:25,559 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0092_warn_about_dbt_data_type_diff' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0092_warn_about_dbt_data_type_diff.py'> (migrator.py:186)
2025-09-15 20:14:25,559 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0093_use_raw_sql_in_fingerprint' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0093_use_raw_sql_in_fingerprint.py'> (migrator.py:186)
2025-09-15 20:14:25,559 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0094_add_dev_version_and_fingerprint_columns' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0094_add_dev_version_and_fingerprint_columns.py'> (migrator.py:186)
2025-09-15 20:14:25,765 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0095_warn_about_dbt_raw_sql_diff' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0095_warn_about_dbt_raw_sql_diff.py'> (migrator.py:186)
2025-09-15 20:14:25,765 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0096_remove_plan_dags_table' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0096_remove_plan_dags_table.py'> (migrator.py:186)
2025-09-15 20:14:25,820 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0097_add_dbt_name_in_node' from '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlmesh/migrations/v0097_add_dbt_name_in_node.py'> (migrator.py:186)
2025-09-15 20:14:25,863 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Fetching environments (migrator.py:208)
2025-09-15 20:14:25,905 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Migrating snapshot rows... (migrator.py:225)
2025-09-15 20:14:25,907 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - No changes to snapshots detected (migrator.py:218)
2025-09-15 20:14:29,854 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-09-15 20:14:30,324 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-15 20:14:30,327 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__facts' (evaluator.py:1360)
2025-09-15 20:14:30,328 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__facts" (base.py:2466)
2025-09-15 20:14:30,454 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__intermediate' (evaluator.py:1360)
2025-09-15 20:14:30,455 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__intermediate" (base.py:2466)
2025-09-15 20:14:30,568 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__staging' (evaluator.py:1360)
2025-09-15 20:14:30,568 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__staging" (base.py:2466)
2025-09-15 20:14:30,682 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-15 20:14:30,700 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__staging (evaluator.py:1463)
2025-09-15 20:14:30,703 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:30,708 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:30,710 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_teams__1922017101', 'staging__stg_ucl_matches__1679965645', 'staging__stg_ucl_squads__1660759538', 'staging__stg_ucl_latlong__3331770713') (base.py:2466)
2025-09-15 20:14:30,743 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__intermediate (evaluator.py:1463)
2025-09-15 20:14:30,743 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:30,745 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:30,748 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__intermediate') AND table_name IN ('intermediate__int_ucl_teams__3354823873', 'intermediate__int_ucl_matches__1386915127') (base.py:2466)
2025-09-15 20:14:30,751 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__facts (evaluator.py:1463)
2025-09-15 20:14:30,751 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:30,751 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:30,752 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__facts') AND table_name IN ('facts__fct_ucl_league_standings__3294814566') (base.py:2466)
2025-09-15 20:14:30,760 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_latlong": 1457105801> (evaluator.py:701)
2025-09-15 20:14:30,761 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_latlong": 1457105801> (evaluator.py:910)
2025-09-15 20:14:30,774 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-04 00:00:00, 2025-09-11 00:00:00) into champions_league_data.sqlmesh__staging.staging__stg_ucl_latlong__3331770713' (evaluator.py:940)
2025-09-15 20:14:30,774 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__3331770713" (base.py:2466)
2025-09-15 20:14:30,905 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:30,908 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:30,910 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_latlong__3331770713') (base.py:2466)
2025-09-15 20:14:30,912 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:30,913 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 20:14:30,917 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__3331770713" AS SELECT "team_id" AS "team_id", (CASE WHEN LOWER(TRIM("latitude")) LIKE '%s%' THEN -1 ELSE 1 END) * CAST(REGEXP_REPLACE(TRIM("latitude"), '[^0-9.+-]', '', 'g') AS DOUBLE) AS "latitude", (CASE WHEN LOWER(TRIM("longitude")) LIKE '%w%' THEN -1 ELSE 1 END) * CAST(REGEXP_REPLACE(TRIM("longitude"), '[^0-9.+-]', '', 'g') AS DOUBLE) AS "longitude" FROM "champions_league_data"."main"."ucl_teams_city_latlong" AS "ucl_teams_city_latlong" (base.py:2466)
2025-09-15 20:14:31,029 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ COMMENT ON COLUMN "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__3331770713"."team_id" IS 'Latitude: negative if ''S''' (base.py:2466)
2025-09-15 20:14:31,143 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-04 00:00:00, 2025-09-11 00:00:00) for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_latlong": 1457105801> (facade.py:622)
2025-09-15 20:14:31,143 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_latlong": 1457105801> (interval.py:214)
2025-09-15 20:14:31,541 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_matches": 4250361098> (evaluator.py:701)
2025-09-15 20:14:31,542 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_matches": 4250361098> (evaluator.py:910)
2025-09-15 20:14:31,546 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-04 00:00:00, 2025-09-11 00:00:00) into champions_league_data.sqlmesh__staging.staging__stg_ucl_matches__1679965645' (evaluator.py:940)
2025-09-15 20:14:31,546 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__1679965645" (base.py:2466)
2025-09-15 20:14:31,628 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:31,629 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:31,630 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_matches__1679965645') (base.py:2466)
2025-09-15 20:14:31,632 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:31,633 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 20:14:31,641 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__1679965645" AS SELECT "competition_id" AS "competition_id", "competition_name" AS "competition_name", "competition_code" AS "competition_code", "season_id" AS "season_id", "season_startdate" AS "season_start_date", "season_enddate" AS "season_end_date", "season_currentmatchday" AS "season_current_matchday", "id" AS "match_id", CAST(CAST("utcdate" AS TIMESTAMPTZ) AT TIME ZONE 'America/New_York' AS TIMESTAMP) AS "match_datetime_est", "status" AS "match_status", "matchday" AS "matchday", "stage" AS "stage", "group" AS "group", "lastupdated" AS "lastupdated", "hometeam_id" AS "hometeam_id", "hometeam_name" AS "hometeam_name", "hometeam_shortname" AS "hometeam_shortname", "hometeam_tla" AS "hometeam_tla", "awayteam_id" AS "awayteam_id", "awayteam_name" AS "awayteam_name", "awayteam_shortname" AS "awayteam_shortname", "awayteam_tla" AS "awayteam_tla", "score_winner" AS "score_winner", "score_duration" AS "score_duration", "score_fulltime_home" AS "score_fulltime_home", "score_fulltime_away" AS "score_fulltime_away", "score_halftime_home" AS "score_halftime_home", "score_halftime_away" AS "score_halftime_away", "referees" AS "referees" FROM "champions_league_data"."main"."champions_league_matches" AS "champions_league_matches" (base.py:2466)
2025-09-15 20:14:31,774 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-04 00:00:00, 2025-09-11 00:00:00) for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_matches": 4250361098> (facade.py:622)
2025-09-15 20:14:31,774 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_matches": 4250361098> (interval.py:214)
2025-09-15 20:14:32,190 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_squads": 2971406461> (evaluator.py:701)
2025-09-15 20:14:32,191 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_squads": 2971406461> (evaluator.py:910)
2025-09-15 20:14:32,193 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-04 00:00:00, 2025-09-11 00:00:00) into champions_league_data.sqlmesh__staging.staging__stg_ucl_squads__1660759538' (evaluator.py:940)
2025-09-15 20:14:32,193 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_squads__1660759538" (base.py:2466)
2025-09-15 20:14:32,277 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:32,278 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:32,280 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_squads__1660759538') (base.py:2466)
2025-09-15 20:14:32,288 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:32,290 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 20:14:32,291 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_squads__1660759538" AS SELECT "team_id" AS "team_id", "team_name" AS "team_name", "id" AS "player_id", "name" AS "player_name", "position" AS "position", "dateofbirth" AS "date_of_birth", "nationality" AS "nationality" FROM "champions_league_data"."main"."champions_league_team_squad" AS "champions_league_team_squad" (base.py:2466)
2025-09-15 20:14:32,401 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-04 00:00:00, 2025-09-11 00:00:00) for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_squads": 2971406461> (facade.py:622)
2025-09-15 20:14:32,402 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_squads": 2971406461> (interval.py:214)
2025-09-15 20:14:32,724 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 3601238811> (evaluator.py:701)
2025-09-15 20:14:32,724 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 3601238811> (evaluator.py:910)
2025-09-15 20:14:32,727 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-04 00:00:00, 2025-09-11 00:00:00) into champions_league_data.sqlmesh__staging.staging__stg_ucl_teams__1922017101' (evaluator.py:940)
2025-09-15 20:14:32,727 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" (base.py:2466)
2025-09-15 20:14:32,812 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:32,813 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:32,815 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_teams__1922017101') (base.py:2466)
2025-09-15 20:14:32,819 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:32,821 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 20:14:32,823 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" AS SELECT "area_name" AS "area_name", "id" AS "team_id", "name" AS "team_name", "shortname" AS "team_short_name", "tla" AS "team_tla", "address" AS "team_address", "venue" AS "team_venue", "coach_id" AS "coach_id", "coach_firstname" AS "coach_first_name", "coach_lastname" AS "coach_last_name", "coach_name" AS "coach_name", "coach_nationality" AS "coach_nationality", "coach_contract_start" AS "coach_contract_start", "coach_contract_until" AS "coach_contract_until", "lastupdated" AS "lastupdated", "latitude" AS "latitude", "longitude" AS "longitude" FROM "champions_league_data"."main"."champions_league_teams" AS "champions_league_teams" (base.py:2466)
2025-09-15 20:14:33,103 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-04 00:00:00, 2025-09-11 00:00:00) for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 3601238811> (facade.py:622)
2025-09-15 20:14:33,103 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_teams": 3601238811> (interval.py:214)
2025-09-15 20:14:33,461 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_teams": 107671120> (evaluator.py:701)
2025-09-15 20:14:33,462 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_teams": 107671120> (evaluator.py:910)
2025-09-15 20:14:33,466 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-04 00:00:00, 2025-09-11 00:00:00) into champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_teams__3354823873' (evaluator.py:940)
2025-09-15 20:14:33,466 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ DESCRIBE "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__3354823873" (base.py:2466)
2025-09-15 20:14:33,548 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:33,549 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:33,551 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__intermediate') AND table_name IN ('intermediate__int_ucl_teams__3354823873') (base.py:2466)
2025-09-15 20:14:33,557 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:33,558 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 20:14:33,560 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__3354823873" AS SELECT "t"."area_name" AS "area_name", "t"."team_id" AS "team_id", "t"."team_name" AS "team_name", "t"."team_short_name" AS "team_short_name", "t"."team_tla" AS "team_tla", "t"."team_address" AS "team_address", "t"."team_venue" AS "team_venue", "t"."coach_id" AS "coach_id", "t"."coach_first_name" AS "coach_first_name", "t"."coach_last_name" AS "coach_last_name", "t"."coach_name" AS "coach_name", "t"."coach_nationality" AS "coach_nationality", "t"."coach_contract_start" AS "coach_contract_start", "t"."coach_contract_until" AS "coach_contract_until", "t"."lastupdated" AS "lastupdated", "l"."latitude" AS "latitude", "l"."longitude" AS "longitude", "r"."rank" AS "european_rank", RANK() OVER (PARTITION BY "t"."team_id" ORDER BY "r"."rank") AS "ucl_rank" FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" AS "t" JOIN "champions_league_data"."main"."ucl_teams_city_latlong" AS "l" ON "t"."team_id" = "l"."team_id" JOIN "champions_league_data"."main"."ucl_european_rankings" AS "r" ON "t"."team_id" = "r"."team_id" (base.py:2466)
2025-09-15 20:14:33,682 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-04 00:00:00, 2025-09-11 00:00:00) for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_teams": 107671120> (facade.py:622)
2025-09-15 20:14:33,682 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_teams": 107671120> (interval.py:214)
2025-09-15 20:14:34,025 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_matches": 953782283> (evaluator.py:701)
2025-09-15 20:14:34,026 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_matches": 953782283> (evaluator.py:910)
2025-09-15 20:14:34,049 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-04 00:00:00, 2025-09-11 00:00:00) into champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_matches__1386915127' (evaluator.py:940)
2025-09-15 20:14:34,049 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ DESCRIBE "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__1386915127" (base.py:2466)
2025-09-15 20:14:34,133 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:34,134 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:34,137 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__intermediate') AND table_name IN ('intermediate__int_ucl_matches__1386915127') (base.py:2466)
2025-09-15 20:14:34,142 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:34,147 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 20:14:34,152 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__1386915127" AS SELECT "m"."competition_id" AS "competition_id", "m"."competition_name" AS "competition_name", "m"."competition_code" AS "competition_code", "m"."season_id" AS "season_id", "m"."season_start_date" AS "season_start_date", "m"."season_end_date" AS "season_end_date", "m"."season_current_matchday" AS "season_current_matchday", "m"."match_id" AS "match_id", "m"."match_datetime_est" AS "match_datetime_est", "m"."match_status" AS "match_status", "m"."matchday" AS "matchday", "m"."stage" AS "stage", "m"."group" AS "group", "m"."lastupdated" AS "lastupdated", "m"."hometeam_id" AS "hometeam_id", "m"."hometeam_name" AS "hometeam_name", "m"."hometeam_shortname" AS "hometeam_shortname", "m"."hometeam_tla" AS "hometeam_tla", "m"."awayteam_id" AS "awayteam_id", "m"."awayteam_name" AS "awayteam_name", "m"."awayteam_shortname" AS "awayteam_shortname", "m"."awayteam_tla" AS "awayteam_tla", "m"."score_winner" AS "score_winner", "m"."score_duration" AS "score_duration", "m"."score_fulltime_home" AS "score_fulltime_home", "m"."score_fulltime_away" AS "score_fulltime_away", "m"."score_halftime_home" AS "score_halftime_home", "m"."score_halftime_away" AS "score_halftime_away", "m"."referees" AS "referees", "l"."latitude" AS "hometeam_latitude", "l"."longitude" AS "hometeam_longitude", "ll"."latitude" AS "awayteam_latitude", "ll"."longitude" AS "awayteam_longitude", "t"."european_rank" AS "hometeam_european_rank", "tt"."european_rank" AS "awayteam_european_rank", "t"."ucl_rank" AS "hometeam_ucl_rank", "tt"."ucl_rank" AS "awayteam_ucl_rank" FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__1679965645" AS "m" JOIN "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__3354823873" AS "t" ON "m"."hometeam_id" = "t"."team_id" JOIN "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__3354823873" AS "tt" ON "m"."awayteam_id" = "tt"."team_id" JOIN "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__3331770713" AS "l" ON "l"."team_id" = "m"."hometeam_id", "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__3331770713" AS "ll" (base.py:2466)
2025-09-15 20:14:34,338 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-04 00:00:00, 2025-09-11 00:00:00) for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_matches": 953782283> (facade.py:622)
2025-09-15 20:14:34,338 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."intermediate"."int_ucl_matches": 953782283> (interval.py:214)
2025-09-15 20:14:34,640 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 3638780536> (evaluator.py:701)
2025-09-15 20:14:34,640 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 3638780536> (evaluator.py:910)
2025-09-15 20:14:34,674 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-04 00:00:00, 2025-09-11 00:00:00) into champions_league_data.sqlmesh__facts.facts__fct_ucl_league_standings__3294814566' (evaluator.py:940)
2025-09-15 20:14:34,674 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ DESCRIBE "champions_league_data"."sqlmesh__facts"."facts__fct_ucl_league_standings__3294814566" (base.py:2466)
2025-09-15 20:14:34,755 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:34,756 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:34,757 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__facts') AND table_name IN ('facts__fct_ucl_league_standings__3294814566') (base.py:2466)
2025-09-15 20:14:34,761 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:34,761 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-15 20:14:34,766 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__facts"."facts__fct_ucl_league_standings__3294814566" AS WITH "hometeam" AS (SELECT "int_ucl_matches"."match_id" AS "match_id", "int_ucl_matches"."match_status" AS "match_status", "int_ucl_matches"."matchday" AS "matchday", "int_ucl_matches"."season_current_matchday" AS "season_current_matchday", "int_ucl_matches"."hometeam_id" AS "team_id", "int_ucl_matches"."hometeam_tla" AS "team_tla", 'HOME_TEAM' AS "home_away", "int_ucl_matches"."score_fulltime_home" AS "score_fulltime", "int_ucl_matches"."score_halftime_home" AS "score_halftime", "int_ucl_matches"."score_winner" AS "score_winner" FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__1386915127" AS "int_ucl_matches" WHERE "int_ucl_matches"."stage" = 'LEAGUE_STAGE'), "awayteam" AS (SELECT "int_ucl_matches"."match_id" AS "match_id", "int_ucl_matches"."match_status" AS "match_status", "int_ucl_matches"."matchday" AS "matchday", "int_ucl_matches"."season_current_matchday" AS "season_current_matchday", "int_ucl_matches"."awayteam_id" AS "team_id", "int_ucl_matches"."awayteam_tla" AS "team_tla", 'AWAY_TEAM' AS "home_away", "int_ucl_matches"."score_fulltime_away" AS "score_fulltime", "int_ucl_matches"."score_halftime_away" AS "score_halftime", "int_ucl_matches"."score_winner" AS "score_winner" FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__1386915127" AS "int_ucl_matches" WHERE "int_ucl_matches"."stage" = 'LEAGUE_STAGE'), "unioned_data" AS (SELECT "hometeam"."match_id" AS "match_id", "hometeam"."match_status" AS "match_status", "hometeam"."matchday" AS "matchday", "hometeam"."season_current_matchday" AS "season_current_matchday", "hometeam"."team_id" AS "team_id", "hometeam"."team_tla" AS "team_tla", "hometeam"."home_away" AS "home_away", "hometeam"."score_fulltime" AS "score_fulltime", "hometeam"."score_halftime" AS "score_halftime", "hometeam"."score_winner" AS "score_winner" FROM "hometeam" AS "hometeam" UNION ALL SELECT "awayteam"."match_id" AS "match_id", "awayteam"."match_status" AS "match_status", "awayteam"."matchday" AS "matchday", "awayteam"."season_current_matchday" AS "season_current_matchday", "awayteam"."team_id" AS "team_id", "awayteam"."team_tla" AS "team_tla", "awayteam"."home_away" AS "home_away", "awayteam"."score_fulltime" AS "score_fulltime", "awayteam"."score_halftime" AS "score_halftime", "awayteam"."score_winner" AS "score_winner" FROM "awayteam" AS "awayteam"), "points" AS (SELECT "ud"."match_id" AS "match_id", "ud"."matchday" AS "matchday", "ud"."team_id" AS "team_id", "ud"."team_tla" AS "team_tla", "t"."team_name" AS "team_name", "ud"."home_away" AS "home_away", "ud"."score_fulltime" AS "score_fulltime", "ud"."score_winner" AS "score_winner", SUM(CAST("ud"."score_halftime" AS INT)) OVER (PARTITION BY "ud"."team_id" ORDER BY "ud"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "halftime_goals_scored", SUM(CAST("ud"."score_fulltime" AS INT)) OVER (PARTITION BY "ud"."team_id" ORDER BY "ud"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "total_goals_scored", CASE WHEN "ud"."home_away" = "ud"."score_winner" THEN 3 WHEN "ud"."score_winner" = 'DRAW' THEN 1 ELSE 0 END AS "points_earned" FROM "unioned_data" AS "ud" LEFT JOIN "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__3354823873" AS "t" ON "t"."team_id" = "ud"."team_id"), "goals_conceded" AS (SELECT "p"."match_id" AS "match_id", "p"."matchday" AS "matchday", "p"."team_id" AS "team_id", "p"."team_tla" AS "team_tla", "p"."team_name" AS "team_name", "p"."home_away" AS "home_away", "p"."score_fulltime" AS "score_fulltime", "p"."score_winner" AS "score_winner", "p"."halftime_goals_scored" AS "halftime_goals_scored", "p"."total_goals_scored" AS "total_goals_scored", "p"."points_earned" AS "points_earned", SUM(CAST("p"."points_earned" AS INT)) OVER (PARTITION BY "p"."team_id" ORDER BY "p"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "total_points_earned", "pp"."score_fulltime" AS "goals_conceded", SUM(CAST("pp"."score_fulltime" AS INT)) OVER (PARTITION BY "p"."team_id" ORDER BY "p"."matchday" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "total_goals_conceded" FROM "points" AS "p" JOIN "points" AS "pp" ON "p"."match_id" = "pp"."match_id" AND "p"."team_id" <> "pp"."team_id") SELECT "goals_conceded"."matchday" AS "matchday", "goals_conceded"."team_tla" AS "team_tla", "goals_conceded"."team_name" AS "team_name", "goals_conceded"."total_points_earned" AS "total_points_earned", "goals_conceded"."total_goals_scored" AS "total_goals_scored", "goals_conceded"."total_goals_conceded" AS "total_goals_conceded", "goals_conceded"."total_goals_scored" - "goals_conceded"."total_goals_conceded" AS "goal_differential" FROM "goals_conceded" AS "goals_conceded" ORDER BY "matchday", "total_points_earned" DESC, "goal_differential" DESC, "total_goals_scored" DESC, "team_name" (base.py:2466)
2025-09-15 20:14:39,827 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-04 00:00:00, 2025-09-11 00:00:00) for snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 3638780536> (facade.py:622)
2025-09-15 20:14:39,827 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."facts"."fct_ucl_league_standings": 3638780536> (interval.py:214)
2025-09-15 20:14:40,132 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-09-15 20:14:40,132 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-15 20:14:40,610 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-09-15 20:14:40,769 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-09-15 20:14:40,773 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.facts' (evaluator.py:1360)
2025-09-15 20:14:40,773 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."facts" (base.py:2466)
2025-09-15 20:14:40,819 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.intermediate' (evaluator.py:1360)
2025-09-15 20:14:40,820 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."intermediate" (base.py:2466)
2025-09-15 20:14:40,870 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.staging' (evaluator.py:1360)
2025-09-15 20:14:40,871 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."staging" (base.py:2466)
2025-09-15 20:14:40,913 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_latlong' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_latlong__3331770713' (evaluator.py:1732)
2025-09-15 20:14:40,915 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:40,916 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:40,918 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_latlong') (base.py:2466)
2025-09-15 20:14:40,925 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_latlong" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__3331770713" (base.py:2466)
2025-09-15 20:14:41,026 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ COMMENT ON COLUMN "champions_league_data"."staging"."stg_ucl_latlong"."team_id" IS 'Latitude: negative if ''S''' (base.py:2466)
2025-09-15 20:14:41,172 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_matches' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_matches__1679965645' (evaluator.py:1732)
2025-09-15 20:14:41,206 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,221 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,223 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_matches') (base.py:2466)
2025-09-15 20:14:41,234 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_matches" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__1679965645" (base.py:2466)
2025-09-15 20:14:41,366 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_squads' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_squads__1660759538' (evaluator.py:1732)
2025-09-15 20:14:41,367 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,367 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,368 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_squads') (base.py:2466)
2025-09-15 20:14:41,373 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_squads" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_squads__1660759538" (base.py:2466)
2025-09-15 20:14:41,479 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_teams' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_teams__1922017101' (evaluator.py:1732)
2025-09-15 20:14:41,480 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,480 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,481 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_teams') (base.py:2466)
2025-09-15 20:14:41,484 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_teams" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" (base.py:2466)
2025-09-15 20:14:41,581 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.intermediate.int_ucl_teams' to point at table 'champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_teams__3354823873' (evaluator.py:1732)
2025-09-15 20:14:41,581 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,582 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,584 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'intermediate') AND table_name IN ('int_ucl_teams') (base.py:2466)
2025-09-15 20:14:41,588 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE VIEW "champions_league_data"."intermediate"."int_ucl_teams" AS SELECT * FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__3354823873" (base.py:2466)
2025-09-15 20:14:41,699 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.intermediate.int_ucl_matches' to point at table 'champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_matches__1386915127' (evaluator.py:1732)
2025-09-15 20:14:41,699 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,700 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,701 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'intermediate') AND table_name IN ('int_ucl_matches') (base.py:2466)
2025-09-15 20:14:41,704 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE VIEW "champions_league_data"."intermediate"."int_ucl_matches" AS SELECT * FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__1386915127" (base.py:2466)
2025-09-15 20:14:41,800 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.facts.fct_ucl_league_standings' to point at table 'champions_league_data.sqlmesh__facts.facts__fct_ucl_league_standings__3294814566' (evaluator.py:1732)
2025-09-15 20:14:41,801 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,801 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-15 20:14:41,803 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'facts') AND table_name IN ('fct_ucl_league_standings') (base.py:2466)
2025-09-15 20:14:41,807 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 88e1f48a167e4eda83b098682971cbc6 */ CREATE OR REPLACE VIEW "champions_league_data"."facts"."fct_ucl_league_standings" AS SELECT * FROM "champions_league_data"."sqlmesh__facts"."facts__fct_ucl_league_standings__3294814566" (base.py:2466)
2025-09-15 20:14:41,912 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-09-15 20:14:41,913 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-09-15 20:14:42,018 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
