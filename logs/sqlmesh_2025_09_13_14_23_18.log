2025-09-13 14:23:18,354 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'md:champions_league_data'} (connection.py:489)
2025-09-13 14:23:18,679 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-09-13 14:23:18,680 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"champions_league_data"."sqlmesh_example"."full_model"' was not found at /Users/AaronHarkins/Python/SQLMesh_Motherduck/tests/test_full_model.yaml (console.py:2260)
2025-09-13 14:23:18,681 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: md:champions_league_data (connection.py:479)
2025-09-13 14:23:18,681 - MainThread - sqlmesh.core.console - WARNING - The motherduck engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-09-13 14:23:21,656 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-09-13 14:23:22,228 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-13 14:23:22,229 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__staging' (evaluator.py:1360)
2025-09-13 14:23:22,229 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__staging" (base.py:2466)
2025-09-13 14:23:22,274 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-13 14:23:22,275 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__staging (evaluator.py:1463)
2025-09-13 14:23:22,276 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:23:22,277 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:23:22,279 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_squads__1660759538') (base.py:2466)
2025-09-13 14:23:22,294 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_squads": 1067257708> (evaluator.py:701)
2025-09-13 14:23:22,294 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_squads": 1067257708> (evaluator.py:910)
2025-09-13 14:23:22,297 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-31 00:00:00, 2025-09-07 00:00:00) into champions_league_data.sqlmesh__staging.staging__stg_ucl_squads__1660759538' (evaluator.py:940)
2025-09-13 14:23:22,297 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ DESCRIBE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_squads__1660759538" (base.py:2466)
2025-09-13 14:23:22,388 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:23:22,389 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:23:22,391 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_squads__1660759538') (base.py:2466)
2025-09-13 14:23:22,396 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:23:22,397 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-13 14:23:22,399 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ CREATE OR REPLACE TABLE "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_squads__1660759538" AS SELECT "team_id" AS "team_id", "team_name" AS "team_name", "id" AS "player_id", "name" AS "player_name", "position" AS "position", "dateofbirth" AS "date_of_birth", "nationality" AS "nationality" FROM "champions_league_data"."main"."champions_league_team_squad" AS "champions_league_team_squad" (base.py:2466)
2025-09-13 14:23:22,523 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-31 00:00:00, 2025-09-07 00:00:00) for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_squads": 1067257708> (facade.py:622)
2025-09-13 14:23:22,523 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"champions_league_data"."staging"."stg_ucl_squads": 1067257708> (interval.py:214)
2025-09-13 14:23:22,863 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-09-13 14:23:22,863 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-13 14:23:23,531 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-09-13 14:23:23,783 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-09-13 14:23:23,789 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.staging' (evaluator.py:1360)
2025-09-13 14:23:23,790 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."staging" (base.py:2466)
2025-09-13 14:23:23,836 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_squads' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_squads__1660759538' (evaluator.py:1732)
2025-09-13 14:23:23,837 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:23:23,838 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-13 14:23:23,841 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_squads') (base.py:2466)
2025-09-13 14:23:23,848 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: a28845d290a04763bba66bb94037c046 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_squads" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_squads__1660759538" (base.py:2466)
2025-09-13 14:23:23,953 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-09-13 14:23:23,953 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-09-13 14:23:24,112 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
