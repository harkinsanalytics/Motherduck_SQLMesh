2025-09-16 18:07:29,650 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'md:champions_league_data'} (connection.py:489)
2025-09-16 18:07:30,070 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-09-16 18:07:30,071 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"champions_league_data"."sqlmesh_example"."full_model"' was not found at /Users/AaronHarkins/Python/SQLMesh_Motherduck/tests/test_full_model.yaml (console.py:2260)
2025-09-16 18:07:30,073 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: md:champions_league_data (connection.py:479)
2025-09-16 18:07:30,073 - MainThread - sqlmesh.core.console - WARNING - The motherduck engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-09-16 18:07:35,268 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-09-16 18:07:35,673 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-16 18:07:35,674 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__intermediate' (evaluator.py:1360)
2025-09-16 18:07:35,675 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__intermediate" (base.py:2466)
2025-09-16 18:07:35,714 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__facts' (evaluator.py:1360)
2025-09-16 18:07:35,714 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__facts" (base.py:2466)
2025-09-16 18:07:35,754 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__snapshots' (evaluator.py:1360)
2025-09-16 18:07:35,754 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__snapshots" (base.py:2466)
2025-09-16 18:07:35,806 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.sqlmesh__staging' (evaluator.py:1360)
2025-09-16 18:07:35,806 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."sqlmesh__staging" (base.py:2466)
2025-09-16 18:07:35,846 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-09-16 18:07:35,851 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__snapshots (evaluator.py:1463)
2025-09-16 18:07:35,852 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:35,854 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:35,856 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__snapshots') AND table_name IN ('snapshots__ucl_squad_snapshot__2525434465', 'snapshots__ucl_team_snapshot__3185020588', 'snapshots__ucl_matches_snapshot__1551174535') (base.py:2466)
2025-09-16 18:07:35,878 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__staging (evaluator.py:1463)
2025-09-16 18:07:35,878 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:35,879 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:35,880 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__stg_ucl_matches__1679965645', 'staging__stg_ucl_squads__1660759538', 'staging__stg_ucl_teams__1922017101', 'staging__stg_ucl_latlong__3331770713') (base.py:2466)
2025-09-16 18:07:35,884 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__intermediate (evaluator.py:1463)
2025-09-16 18:07:35,884 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:35,884 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:35,885 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__intermediate') AND table_name IN ('intermediate__int_ucl_matches__1875354215', 'intermediate__int_ucl_teams__2148090398') (base.py:2466)
2025-09-16 18:07:35,889 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema champions_league_data.sqlmesh__facts (evaluator.py:1463)
2025-09-16 18:07:35,889 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:35,889 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:35,890 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'sqlmesh__facts') AND table_name IN ('facts__fct_ucl_league_standings__1887280180') (base.py:2466)
2025-09-16 18:07:35,895 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating a physical table for snapshot SnapshotId<"champions_league_data"."snapshots"."ucl_matches_snapshot": 84905268> (evaluator.py:838)
2025-09-16 18:07:35,910 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'champions_league_data.sqlmesh__snapshots.snapshots__ucl_matches_snapshot__1551174535' (evaluator.py:1768)
2025-09-16 18:07:35,910 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:35,911 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'champions_league_data' (base.py:2466)
2025-09-16 18:07:35,913 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE TABLE IF NOT EXISTS "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_matches_snapshot__1551174535" AS SELECT CURRENT_DATE AS "snapshot_date", "int_ucl_matches"."competition_id" AS "competition_id", "int_ucl_matches"."competition_name" AS "competition_name", "int_ucl_matches"."competition_code" AS "competition_code", "int_ucl_matches"."season_id" AS "season_id", "int_ucl_matches"."season_start_date" AS "season_start_date", "int_ucl_matches"."season_end_date" AS "season_end_date", "int_ucl_matches"."season_current_matchday" AS "season_current_matchday", "int_ucl_matches"."match_id" AS "match_id", "int_ucl_matches"."match_datetime_est" AS "match_datetime_est", "int_ucl_matches"."match_status" AS "match_status", "int_ucl_matches"."matchday" AS "matchday", "int_ucl_matches"."stage" AS "stage", "int_ucl_matches"."group" AS "group", "int_ucl_matches"."lastupdated" AS "lastupdated", "int_ucl_matches"."hometeam_id" AS "hometeam_id", "int_ucl_matches"."hometeam_name" AS "hometeam_name", "int_ucl_matches"."hometeam_shortname" AS "hometeam_shortname", "int_ucl_matches"."hometeam_tla" AS "hometeam_tla", "int_ucl_matches"."awayteam_id" AS "awayteam_id", "int_ucl_matches"."awayteam_name" AS "awayteam_name", "int_ucl_matches"."awayteam_shortname" AS "awayteam_shortname", "int_ucl_matches"."awayteam_tla" AS "awayteam_tla", "int_ucl_matches"."score_winner" AS "score_winner", "int_ucl_matches"."score_duration" AS "score_duration", "int_ucl_matches"."score_fulltime_home" AS "score_fulltime_home", "int_ucl_matches"."score_fulltime_away" AS "score_fulltime_away", "int_ucl_matches"."score_halftime_home" AS "score_halftime_home", "int_ucl_matches"."score_halftime_away" AS "score_halftime_away", "int_ucl_matches"."referees" AS "referees", "int_ucl_matches"."hometeam_latitude" AS "hometeam_latitude", "int_ucl_matches"."hometeam_longitude" AS "hometeam_longitude", "int_ucl_matches"."awayteam_latitude" AS "awayteam_latitude", "int_ucl_matches"."awayteam_longitude" AS "awayteam_longitude", "int_ucl_matches"."hometeam_european_rank" AS "hometeam_european_rank", "int_ucl_matches"."awayteam_european_rank" AS "awayteam_european_rank", "int_ucl_matches"."hometeam_ucl_rank" AS "hometeam_ucl_rank", "int_ucl_matches"."awayteam_ucl_rank" AS "awayteam_ucl_rank", "int_ucl_matches"."distance_in_miles" AS "distance_in_miles", "int_ucl_matches"."week_starting_date" AS "week_starting_date", "int_ucl_matches"."week_ending_date" AS "week_ending_date" FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__1875354215" AS "int_ucl_matches" WHERE ("int_ucl_matches"."match_datetime_est" < CURRENT_DATE AND "int_ucl_matches"."match_status" = 'FINISHED') AND FALSE LIMIT 0 (base.py:2466)
2025-09-16 18:07:36,012 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-16 18:07:36,012 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-09-16 18:07:36,012 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:165)
2025-09-16 18:07:36,591 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-09-16 18:07:36,751 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-09-16 18:07:36,760 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.intermediate' (evaluator.py:1360)
2025-09-16 18:07:36,760 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."intermediate" (base.py:2466)
2025-09-16 18:07:36,800 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.facts' (evaluator.py:1360)
2025-09-16 18:07:36,800 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."facts" (base.py:2466)
2025-09-16 18:07:36,839 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.staging' (evaluator.py:1360)
2025-09-16 18:07:36,840 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."staging" (base.py:2466)
2025-09-16 18:07:36,887 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'champions_league_data.snapshots' (evaluator.py:1360)
2025-09-16 18:07:36,887 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE SCHEMA IF NOT EXISTS "champions_league_data"."snapshots" (base.py:2466)
2025-09-16 18:07:36,927 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_latlong' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_latlong__3331770713' (evaluator.py:1732)
2025-09-16 18:07:36,928 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:36,929 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:36,930 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_latlong') (base.py:2466)
2025-09-16 18:07:36,936 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_latlong" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_latlong__3331770713" (base.py:2466)
2025-09-16 18:07:37,056 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ COMMENT ON COLUMN "champions_league_data"."staging"."stg_ucl_latlong"."team_id" IS 'Latitude: negative if ''S''' (base.py:2466)
2025-09-16 18:07:37,163 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_matches' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_matches__1679965645' (evaluator.py:1732)
2025-09-16 18:07:37,164 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,165 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,166 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_matches') (base.py:2466)
2025-09-16 18:07:37,173 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_matches" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_matches__1679965645" (base.py:2466)
2025-09-16 18:07:37,279 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_squads' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_squads__1660759538' (evaluator.py:1732)
2025-09-16 18:07:37,279 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,280 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,281 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_squads') (base.py:2466)
2025-09-16 18:07:37,286 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_squads" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_squads__1660759538" (base.py:2466)
2025-09-16 18:07:37,384 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.staging.stg_ucl_teams' to point at table 'champions_league_data.sqlmesh__staging.staging__stg_ucl_teams__1922017101' (evaluator.py:1732)
2025-09-16 18:07:37,385 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,385 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,386 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'staging') AND table_name IN ('stg_ucl_teams') (base.py:2466)
2025-09-16 18:07:37,390 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE OR REPLACE VIEW "champions_league_data"."staging"."stg_ucl_teams" AS SELECT * FROM "champions_league_data"."sqlmesh__staging"."staging__stg_ucl_teams__1922017101" (base.py:2466)
2025-09-16 18:07:37,487 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.intermediate.int_ucl_teams' to point at table 'champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_teams__2148090398' (evaluator.py:1732)
2025-09-16 18:07:37,488 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,488 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,489 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'intermediate') AND table_name IN ('int_ucl_teams') (base.py:2466)
2025-09-16 18:07:37,492 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE OR REPLACE VIEW "champions_league_data"."intermediate"."int_ucl_teams" AS SELECT * FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_teams__2148090398" (base.py:2466)
2025-09-16 18:07:37,591 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.snapshots.ucl_squad_snapshot' to point at table 'champions_league_data.sqlmesh__snapshots.snapshots__ucl_squad_snapshot__2525434465' (evaluator.py:1732)
2025-09-16 18:07:37,592 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,592 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,593 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'snapshots') AND table_name IN ('ucl_squad_snapshot') (base.py:2466)
2025-09-16 18:07:37,596 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE OR REPLACE VIEW "champions_league_data"."snapshots"."ucl_squad_snapshot" AS SELECT * FROM "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_squad_snapshot__2525434465" (base.py:2466)
2025-09-16 18:07:37,693 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.intermediate.int_ucl_matches' to point at table 'champions_league_data.sqlmesh__intermediate.intermediate__int_ucl_matches__1875354215' (evaluator.py:1732)
2025-09-16 18:07:37,693 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,694 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,694 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'intermediate') AND table_name IN ('int_ucl_matches') (base.py:2466)
2025-09-16 18:07:37,697 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE OR REPLACE VIEW "champions_league_data"."intermediate"."int_ucl_matches" AS SELECT * FROM "champions_league_data"."sqlmesh__intermediate"."intermediate__int_ucl_matches__1875354215" (base.py:2466)
2025-09-16 18:07:37,797 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.snapshots.ucl_team_snapshot' to point at table 'champions_league_data.sqlmesh__snapshots.snapshots__ucl_team_snapshot__3185020588' (evaluator.py:1732)
2025-09-16 18:07:37,797 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,797 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,798 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'snapshots') AND table_name IN ('ucl_team_snapshot') (base.py:2466)
2025-09-16 18:07:37,801 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE OR REPLACE VIEW "champions_league_data"."snapshots"."ucl_team_snapshot" AS SELECT * FROM "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_team_snapshot__3185020588" (base.py:2466)
2025-09-16 18:07:37,906 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.facts.fct_ucl_league_standings' to point at table 'champions_league_data.sqlmesh__facts.facts__fct_ucl_league_standings__1887280180' (evaluator.py:1732)
2025-09-16 18:07:37,907 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,908 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:37,909 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'facts') AND table_name IN ('fct_ucl_league_standings') (base.py:2466)
2025-09-16 18:07:37,913 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE OR REPLACE VIEW "champions_league_data"."facts"."fct_ucl_league_standings" AS SELECT * FROM "champions_league_data"."sqlmesh__facts"."facts__fct_ucl_league_standings__1887280180" (base.py:2466)
2025-09-16 18:07:38,011 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'champions_league_data.snapshots.ucl_matches_snapshot' to point at table 'champions_league_data.sqlmesh__snapshots.snapshots__ucl_matches_snapshot__1551174535' (evaluator.py:1732)
2025-09-16 18:07:38,011 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:38,012 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-16 18:07:38,013 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'champions_league_data' AND table_schema = 'snapshots') AND table_name IN ('ucl_matches_snapshot') (base.py:2466)
2025-09-16 18:07:38,016 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 7b0837b1b50a4775bcbda9cbd1a8c309 */ CREATE OR REPLACE VIEW "champions_league_data"."snapshots"."ucl_matches_snapshot" AS SELECT * FROM "champions_league_data"."sqlmesh__snapshots"."snapshots__ucl_matches_snapshot__1551174535" (base.py:2466)
2025-09-16 18:07:38,112 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-09-16 18:07:38,112 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-09-16 18:07:38,209 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
